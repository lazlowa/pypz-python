<?xml-stylesheet type="text/xsl" href="../../../../../../mypy-html.xslt"?><mypy-report-file name="core\src\pypz\executors\operator\states.py" module="core.src.pypz.executors.operator.states"><line any_info="No Anys on this line!" content="# =============================================================================" number="1" precision="empty"/><line any_info="No Anys on this line!" content="# Copyright (c) 2024 by Laszlo Anka. All rights reserved." number="2" precision="empty"/><line any_info="No Anys on this line!" content="#" number="3" precision="empty"/><line any_info="No Anys on this line!" content="# Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);" number="4" precision="empty"/><line any_info="No Anys on this line!" content="# you may not use this file except in compliance with the License." number="5" precision="empty"/><line any_info="No Anys on this line!" content="# You may obtain a copy of the License at" number="6" precision="empty"/><line any_info="No Anys on this line!" content="#" number="7" precision="empty"/><line any_info="No Anys on this line!" content="#     http://www.apache.org/licenses/LICENSE-2.0" number="8" precision="empty"/><line any_info="No Anys on this line!" content="#" number="9" precision="empty"/><line any_info="No Anys on this line!" content="# Unless required by applicable law or agreed to in writing, software" number="10" precision="empty"/><line any_info="No Anys on this line!" content="# distributed under the License is distributed on an &quot;AS IS&quot; BASIS," number="11" precision="empty"/><line any_info="No Anys on this line!" content="# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied." number="12" precision="empty"/><line any_info="No Anys on this line!" content="# See the License for the specific language governing permissions and" number="13" precision="empty"/><line any_info="No Anys on this line!" content="# limitations under the License." number="14" precision="empty"/><line any_info="No Anys on this line!" content="# =============================================================================" number="15" precision="empty"/><line any_info="No Anys on this line!" content="from __future__ import annotations" number="16" precision="precise"/><line any_info="No Anys on this line!" content="import concurrent.futures" number="17" precision="precise"/><line any_info="No Anys on this line!" content="from concurrent.futures import ThreadPoolExecutor" number="18" precision="precise"/><line any_info="No Anys on this line!" content="from abc import ABC, abstractmethod" number="19" precision="precise"/><line any_info="No Anys on this line!" content="from typing import Callable, Type, Any, Tuple, Optional" number="20" precision="precise"/><line any_info="No Anys on this line!" content="import types" number="21" precision="precise"/><line any_info="No Anys on this line!" content="import traceback" number="22" precision="precise"/><line any_info="No Anys on this line!" content="import inspect" number="23" precision="precise"/><line any_info="No Anys on this line!" content="" number="24" precision="empty"/><line any_info="No Anys on this line!" content="from pypz.core.commons.loggers import ContextLogger" number="25" precision="any"/><line any_info="No Anys on this line!" content="from pypz.executors.commons import ExecutionMode" number="26" precision="any"/><line any_info="No Anys on this line!" content="from pypz.executors.commons import ExitCodes" number="27" precision="any"/><line any_info="No Anys on this line!" content="from pypz.executors.operator.context import ExecutionContext" number="28" precision="any"/><line any_info="No Anys on this line!" content="from pypz.core.commons.utils import current_time_millis" number="29" precision="any"/><line any_info="No Anys on this line!" content="from pypz.core.specs.instance import Instance" number="30" precision="any"/><line any_info="No Anys on this line!" content="from pypz.core.specs.plugin import ResourceHandlerPlugin, ServicePlugin, PortPlugin, InputPortPlugin" number="31" precision="any"/><line any_info="No Anys on this line!" content="from pypz.executors.operator.signals import BaseSignal, SignalNoOp, SignalServicesStart, SignalTerminate, \" number="32" precision="any"/><line any_info="No Anys on this line!" content="    SignalOperationStart, SignalError, SignalOperationStop, SignalServicesStop, SignalResourcesDeletion, \" number="33" precision="empty"/><line any_info="No Anys on this line!" content="    SignalOperationInit, SignalResourcesCreation, SignalKill" number="34" precision="empty"/><line any_info="No Anys on this line!" content="" number="35" precision="empty"/><line any_info="No Anys on this line!" content="" number="36" precision="empty"/><line any_info="No Anys on this line!" content="class State(ABC):" number="37" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="38" precision="empty"/><line any_info="No Anys on this line!" content="    This class is used to collect and abstract the common logic in all derived states." number="39" precision="empty"/><line any_info="No Anys on this line!" content="    All other states must extend on this class." number="40" precision="empty"/><line any_info="No Anys on this line!" content="" number="41" precision="empty"/><line any_info="No Anys on this line!" content="    :param context: :class:`pypz.executors.operator.context.ExecutionContext`" number="42" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="43" precision="empty"/><line any_info="No Anys on this line!" content="" number="44" precision="empty"/><line any_info="No Anys on this line!" content="    # ============ inner classes =============" number="45" precision="empty"/><line any_info="No Anys on this line!" content="" number="46" precision="empty"/><line any_info="No Anys on this line!" content="    class MethodWrapper:" number="47" precision="precise"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="48" precision="empty"/><line any_info="No Anys on this line!" content="        This class represents the invocation of the plugin objects' method as action. It" number="49" precision="empty"/><line any_info="No Anys on this line!" content="        is used by both the parallel and the sequential executor." number="50" precision="empty"/><line any_info="No Anys on this line!" content="" number="51" precision="empty"/><line any_info="No Anys on this line!" content="        :param state: the state object, where the execution is performed" number="52" precision="empty"/><line any_info="No Anys on this line!" content="        :param instance_name: name of the executable instance" number="53" precision="empty"/><line any_info="No Anys on this line!" content="        :param callable_method: the method of the instance to be invoked" number="54" precision="empty"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="55" precision="empty"/><line any_info="No Anys on this line!" content="" number="56" precision="empty"/><line any_info="No Anys on this line!" content="        def __init__(self, state: State," number="57" precision="precise"/><line any_info="No Anys on this line!" content="                     instance_name: str," number="58" precision="empty"/><line any_info="No Anys on this line!" content="                     callable_method: Callable[[], bool]):" number="59" precision="empty"/><line any_info="No Anys on this line!" content="            self.__state = state" number="60" precision="precise"/><line any_info="No Anys on this line!" content="            self.__instance_name = instance_name" number="61" precision="precise"/><line any_info="No Anys on this line!" content="            self.__callable_method = callable_method" number="62" precision="precise"/><line any_info="No Anys on this line!" content="" number="63" precision="empty"/><line any_info="No Anys on this line!" content="        def __call__(self, *args, **kwargs):" number="64" precision="any"/><line any_info="No Anys on this line!" content="" number="65" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="            before_timestamp_ms = current_time_millis()" number="66" precision="any"/><line any_info="No Anys on this line!" content="" number="67" precision="empty"/><line any_info="No Anys on this line!" content="            try:" number="68" precision="empty"/><line any_info="No Anys on this line!" content="                # Invocation of the actual plugin object's method, which was given as" number="69" precision="empty"/><line any_info="No Anys on this line!" content="                # parameter to this class" number="70" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="                is_completed = self.__callable_method()" number="71" precision="any"/><line any_info="No Anys on this line!" content="" number="72" precision="empty"/><line any_info="No Anys on this line!" content="                # If method's return type has been annotated, then we need to check, if the" number="73" precision="empty"/><line any_info="No Anys on this line!" content="                # method indeed returns the expected type. Raising error if not." number="74" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Explicit (x5)" content="                method_annotations = inspect.get_annotations(self.__callable_method)" number="75" precision="any"/><line any_info="No Anys on this line!" content="" number="76" precision="empty"/><line any_info="No Anys on this line!" content="                # Retrieve the return type. Notice that it might be None in which case we need to set" number="77" precision="empty"/><line any_info="No Anys on this line!" content="                # the type to NoneType to allow checking isinstance" number="78" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="                return_type = None if &quot;return&quot; not in method_annotations else \" number="79" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="                    types.NoneType if method_annotations.get(&quot;return&quot;) is None else method_annotations.get(&quot;return&quot;)" number="80" precision="any"/><line any_info="No Anys on this line!" content="" number="81" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                if ((return_type is not None) and (return_type is not Optional) and" number="82" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="                        (not isinstance(is_completed, return_type))):" number="83" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x7)&#10;Explicit (x2)" content="                    raise TypeError(f&quot;Invalid return type: {type(is_completed)}, boolean expected.&quot;)" number="84" precision="any"/><line any_info="No Anys on this line!" content="            finally:" number="85" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                after_timestamp_ms = current_time_millis()" number="86" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                elapsed_time_ms = after_timestamp_ms - before_timestamp_ms" number="87" precision="any"/><line any_info="No Anys on this line!" content="" number="88" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                self.__state._logger.debug(&quot;%s | Method: %s; State: %s; Start timestamp: %s; &quot;" number="89" precision="any"/><line any_info="No Anys on this line!" content="                                           &quot;Elapsed time: %s [ms]&quot;," number="90" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="                                           self.__instance_name, self.__callable_method.__name__," number="91" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                                           self.__state.__class__.__name__, before_timestamp_ms," number="92" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="                                           elapsed_time_ms)" number="93" precision="any"/><line any_info="No Anys on this line!" content="" number="94" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            return is_completed" number="95" precision="any"/><line any_info="No Anys on this line!" content="" number="96" precision="empty"/><line any_info="No Anys on this line!" content="    # ============ ctor =============" number="97" precision="empty"/><line any_info="No Anys on this line!" content="" number="98" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="    def __init__(self, context: ExecutionContext, *args, **kwargs):" number="99" precision="any"/><line any_info="No Anys on this line!" content="" number="100" precision="empty"/><line any_info="Any Types on this line: &#10;Explicit (x3)" content="        self.__executor: ThreadPoolExecutor = ThreadPoolExecutor(thread_name_prefix=self.__class__.__name__) \" number="101" precision="precise"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            if &quot;executor_pool_size&quot; not in kwargs else \" number="102" precision="imprecise"/><line any_info="Any Types on this line: &#10;Explicit (x3)&#10;Unannotated (x2)" content="            ThreadPoolExecutor(kwargs[&quot;executor_pool_size&quot;], thread_name_prefix=self.__class__.__name__)" number="103" precision="any"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="104" precision="empty"/><line any_info="No Anys on this line!" content="        Handles the execution of plugins' corresponding methods, which can run parallel" number="105" precision="empty"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="106" precision="empty"/><line any_info="No Anys on this line!" content="" number="107" precision="empty"/><line any_info="No Anys on this line!" content="        self._transition_map: dict[Type[BaseSignal], State] = dict()" number="108" precision="imprecise"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="109" precision="empty"/><line any_info="No Anys on this line!" content="        Contains the possible transitions from this state" number="110" precision="empty"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="111" precision="empty"/><line any_info="No Anys on this line!" content="" number="112" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="        self._reason: Optional[BaseSignal] = None" number="113" precision="imprecise"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="114" precision="empty"/><line any_info="No Anys on this line!" content="        Contains the information about the signal that drove the" number="115" precision="empty"/><line any_info="No Anys on this line!" content="        state machine into this state i.e., the reason of this state" number="116" precision="empty"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="117" precision="empty"/><line any_info="No Anys on this line!" content="" number="118" precision="empty"/><line any_info="No Anys on this line!" content="        self._prev_state: Optional[State] = None" number="119" precision="precise"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="120" precision="empty"/><line any_info="No Anys on this line!" content="        Contains the information about the previous state the" number="121" precision="empty"/><line any_info="No Anys on this line!" content="        state machine was in" number="122" precision="empty"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="123" precision="empty"/><line any_info="No Anys on this line!" content="" number="124" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="        self._context: ExecutionContext = context" number="125" precision="any"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="126" precision="empty"/><line any_info="No Anys on this line!" content="        Holds the reference to the actual operator instance that shall be executed" number="127" precision="empty"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="128" precision="empty"/><line any_info="No Anys on this line!" content="" number="129" precision="empty"/><line any_info="No Anys on this line!" content="        self._state_entry_time_ms: int = 0" number="130" precision="precise"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="131" precision="empty"/><line any_info="No Anys on this line!" content="        Stores the state entry epoch time" number="132" precision="empty"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="133" precision="empty"/><line any_info="No Anys on this line!" content="" number="134" precision="empty"/><line any_info="No Anys on this line!" content="        self._response_collector: dict[Callable[[], bool], bool] = dict()" number="135" precision="precise"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="136" precision="empty"/><line any_info="No Anys on this line!" content="        Stores the responses of the plugin objects for each instance. Used to prevent finished" number="137" precision="empty"/><line any_info="No Anys on this line!" content="        instances to be re-scheduled" number="138" precision="empty"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="139" precision="empty"/><line any_info="No Anys on this line!" content="" number="140" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x9)" content="        self._logger: ContextLogger = ContextLogger(self._context.get_operator().get_logger()," number="141" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="                                                    self._context.get_operator().get_full_name()," number="142" precision="any"/><line any_info="No Anys on this line!" content="                                                    self.__class__.__name__)" number="143" precision="precise"/><line any_info="No Anys on this line!" content="" number="144" precision="empty"/><line any_info="No Anys on this line!" content="    # ======== abstract methods =========" number="145" precision="empty"/><line any_info="No Anys on this line!" content="" number="146" precision="empty"/><line any_info="No Anys on this line!" content="    @abstractmethod" number="147" precision="empty"/><line any_info="No Anys on this line!" content="    def on_entry(self) -&gt; None:" number="148" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="149" precision="precise"/><line any_info="No Anys on this line!" content="" number="150" precision="empty"/><line any_info="No Anys on this line!" content="    @abstractmethod" number="151" precision="empty"/><line any_info="No Anys on this line!" content="    def on_exit(self) -&gt; None:" number="152" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="153" precision="precise"/><line any_info="No Anys on this line!" content="" number="154" precision="empty"/><line any_info="No Anys on this line!" content="    @abstractmethod" number="155" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def on_execute(self) -&gt; BaseSignal:" number="156" precision="any"/><line any_info="No Anys on this line!" content="        pass" number="157" precision="precise"/><line any_info="No Anys on this line!" content="" number="158" precision="empty"/><line any_info="No Anys on this line!" content="    # ======== public methods =========" number="159" precision="empty"/><line any_info="No Anys on this line!" content="" number="160" precision="empty"/><line any_info="No Anys on this line!" content="    def get_prev_state(self) -&gt; Optional[State]:" number="161" precision="precise"/><line any_info="No Anys on this line!" content="        return self._prev_state" number="162" precision="precise"/><line any_info="No Anys on this line!" content="" number="163" precision="empty"/><line any_info="No Anys on this line!" content="    def get_transitions(self):" number="164" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        return self._transition_map" number="165" precision="any"/><line any_info="No Anys on this line!" content="" number="166" precision="empty"/><line any_info="No Anys on this line!" content="    def set_transition(self, signal: Type[BaseSignal], new_state: State) -&gt; None:" number="167" precision="imprecise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="        self._logger.debug(&quot;Setting up transition: (%s)--[%s]--&gt;(%s)&quot;, self.__class__.__name__," number="168" precision="any"/><line any_info="No Anys on this line!" content="                           signal.__name__, new_state.__class__.__name__)" number="169" precision="imprecise"/><line any_info="No Anys on this line!" content="" number="170" precision="empty"/><line any_info="No Anys on this line!" content="        if signal in self._transition_map:" number="171" precision="imprecise"/><line any_info="No Anys on this line!" content="            raise AttributeError(f&quot;Signal already registered in transition map: {signal}&quot;)" number="172" precision="imprecise"/><line any_info="No Anys on this line!" content="" number="173" precision="empty"/><line any_info="No Anys on this line!" content="        self._transition_map[signal] = new_state" number="174" precision="imprecise"/><line any_info="No Anys on this line!" content="" number="175" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def on_signal_handling(self, signal: BaseSignal) -&gt; State:" number="176" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="        if not isinstance(signal, BaseSignal):" number="177" precision="any"/><line any_info="Any Types on this line: &#10;Explicit (x2)&#10;Unimported (x1)" content="            raise AttributeError(f&quot;Invalid signal type: {type(signal)}&quot;)" number="178" precision="any"/><line any_info="No Anys on this line!" content="" number="179" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="        if signal.__class__ in self._transition_map:" number="180" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            new_state = self._transition_map[signal.__class__]" number="181" precision="any"/><line any_info="No Anys on this line!" content="" number="182" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            new_state._reason = signal" number="183" precision="any"/><line any_info="No Anys on this line!" content="            new_state._prev_state = self" number="184" precision="precise"/><line any_info="No Anys on this line!" content="" number="185" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="            self.__exit_state()" number="186" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="            new_state.__enter_state()" number="187" precision="any"/><line any_info="No Anys on this line!" content="" number="188" precision="empty"/><line any_info="No Anys on this line!" content="            return new_state" number="189" precision="precise"/><line any_info="No Anys on this line!" content="        else:" number="190" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            if not isinstance(signal, SignalNoOp):" number="191" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.warn(&quot;Unhandled signal in '%s': %s&quot;," number="192" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                                  self.__class__.__name__, signal.__class__.__name__)" number="193" precision="any"/><line any_info="No Anys on this line!" content="" number="194" precision="empty"/><line any_info="No Anys on this line!" content="            return self" number="195" precision="precise"/><line any_info="No Anys on this line!" content="" number="196" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def _schedule(self, *execution_chain: Tuple[str, set[Instance]]," number="197" precision="imprecise"/><line any_info="No Anys on this line!" content="                  break_on_exception: bool = False) -&gt; bool:" number="198" precision="precise"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="199" precision="empty"/><line any_info="No Anys on this line!" content="        Schedules a chain of instances' specified methods for execution via the thread pool" number="200" precision="empty"/><line any_info="No Anys on this line!" content="        executor. Each chain element is represented by a list of instances and the method to" number="201" precision="empty"/><line any_info="No Anys on this line!" content="        be called. Each list will be executed parallel. The next chain element will be" number="202" precision="empty"/><line any_info="No Anys on this line!" content="        executed after all instance methods have been concluded on the current chain element." number="203" precision="empty"/><line any_info="No Anys on this line!" content="        This method blocks until all the scheduled methods are finished." number="204" precision="empty"/><line any_info="No Anys on this line!" content="        Both plugin and operator instance methods can be scheduled." number="205" precision="empty"/><line any_info="No Anys on this line!" content="" number="206" precision="empty"/><line any_info="No Anys on this line!" content="        :param execution_chain: list of tuples, where [0] is the callable method and [1] is the list of instances" number="207" precision="empty"/><line any_info="No Anys on this line!" content="        :param break_on_exception: if True, it will break on the first exception, if False, it will let then chain run" number="208" precision="empty"/><line any_info="No Anys on this line!" content="                                   and only raise an exception at the end" number="209" precision="empty"/><line any_info="No Anys on this line!" content="        :return: True if all methods are finished (returned True), False otherwise" number="210" precision="empty"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="211" precision="empty"/><line any_info="No Anys on this line!" content="" number="212" precision="empty"/><line any_info="No Anys on this line!" content="        all_instances_finished: bool = True" number="213" precision="precise"/><line any_info="Any Types on this line: &#10;Omitted Generics (x3)" content="        error_in_instances: list[str] = list()" number="214" precision="precise"/><line any_info="No Anys on this line!" content="" number="215" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="        for execution_element in execution_chain:" number="216" precision="imprecise"/><line any_info="No Anys on this line!" content="" number="217" precision="empty"/><line any_info="No Anys on this line!" content="            method_name = \" number="218" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)&#10;Error (x1)" content="                execution_element[0] if isinstance(execution_element[0], str) else execution_element[0].__name__" number="219" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            instances = execution_element[1]" number="220" precision="imprecise"/><line any_info="No Anys on this line!" content="" number="221" precision="empty"/><line any_info="Any Types on this line: &#10;Omitted Generics (x3)&#10;Explicit (x3)" content="            futures: dict[concurrent.futures.Future, Callable[[], Any]] = dict()" number="222" precision="imprecise"/><line any_info="Any Types on this line: &#10;Explicit (x3)&#10;Unimported (x3)" content="            method_to_instance: dict[Callable[[], Any], Instance] = dict()" number="223" precision="imprecise"/><line any_info="No Anys on this line!" content="" number="224" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            for instance in instances:" number="225" precision="any"/><line any_info="No Anys on this line!" content="                # Early termination in case an actual instance object does not implement the" number="226" precision="empty"/><line any_info="No Anys on this line!" content="                # specified method" number="227" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="                if not hasattr(instance, method_name):" number="228" precision="any"/><line any_info="No Anys on this line!" content="                    continue" number="229" precision="precise"/><line any_info="No Anys on this line!" content="" number="230" precision="empty"/><line any_info="Any Types on this line: &#10;Explicit (x14)&#10;Omitted Generics (x2)&#10;Unimported (x1)" content="                method_reference = getattr(instance, method_name)" number="231" precision="any"/><line any_info="No Anys on this line!" content="" number="232" precision="empty"/><line any_info="Any Types on this line: &#10;Explicit (x4)" content="                if not isinstance(method_reference, types.MethodType):" number="233" precision="any"/><line any_info="Any Types on this line: &#10;Explicit (x3)" content="                    raise TypeError(f&quot;Invalid callable method type: {type(method_reference)}. &quot;" number="234" precision="any"/><line any_info="No Anys on this line!" content="                                    f&quot;Must be FunctionType of Callable[[], bool].&quot;)" number="235" precision="empty"/><line any_info="No Anys on this line!" content="" number="236" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)&#10;Explicit (x1)" content="                method_to_instance[method_reference] = instance" number="237" precision="any"/><line any_info="No Anys on this line!" content="" number="238" precision="empty"/><line any_info="No Anys on this line!" content="                if method_reference not in self._response_collector:" number="239" precision="precise"/><line any_info="No Anys on this line!" content="                    self._response_collector[method_reference] = False" number="240" precision="precise"/><line any_info="No Anys on this line!" content="" number="241" precision="empty"/><line any_info="No Anys on this line!" content="                if not self._response_collector[method_reference]:" number="242" precision="precise"/><line any_info="Any Types on this line: &#10;Omitted Generics (x4)&#10;Explicit (x1)&#10;Unannotated (x4)&#10;Unimported (x3)" content="                    futures[self.__executor.submit(State.MethodWrapper(self, instance.get_simple_name()," number="243" precision="any"/><line any_info="No Anys on this line!" content="                                                                       method_reference))] = method_reference" number="244" precision="precise"/><line any_info="No Anys on this line!" content="" number="245" precision="empty"/><line any_info="Any Types on this line: &#10;Omitted Generics (x4)&#10;Explicit (x4)" content="            for future, method_reference in futures.items():" number="246" precision="any"/><line any_info="No Anys on this line!" content="                # Early termination, if the future has been prematurely cancelled. This can be" number="247" precision="empty"/><line any_info="No Anys on this line!" content="                # the case, if a shutdown hook has been caught and the state executors has been" number="248" precision="empty"/><line any_info="No Anys on this line!" content="                # shut down in it" number="249" precision="empty"/><line any_info="Any Types on this line: &#10;Omitted Generics (x1)" content="                if future.cancelled():" number="250" precision="imprecise"/><line any_info="No Anys on this line!" content="                    continue" number="251" precision="precise"/><line any_info="No Anys on this line!" content="" number="252" precision="empty"/><line any_info="No Anys on this line!" content="                try:" number="253" precision="empty"/><line any_info="Any Types on this line: &#10;Omitted Generics (x3)&#10;Explicit (x1)" content="                    self._response_collector[method_reference] = future.result()" number="254" precision="any"/><line any_info="No Anys on this line!" content="" number="255" precision="empty"/><line any_info="No Anys on this line!" content="                    # With this logic we make sure that once the flag has been set to False" number="256" precision="empty"/><line any_info="No Anys on this line!" content="                    # it remains False i.e., if one instance is not complete the entire" number="257" precision="empty"/><line any_info="No Anys on this line!" content="                    # chain is not complete" number="258" precision="empty"/><line any_info="Any Types on this line: &#10;Explicit (x1)" content="                    if all_instances_finished and isinstance(self._response_collector[method_reference], bool):" number="259" precision="any"/><line any_info="Any Types on this line: &#10;Explicit (x1)" content="                        all_instances_finished = self._response_collector[method_reference]" number="260" precision="any"/><line any_info="No Anys on this line!" content="                except Exception as e:" number="261" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x4)&#10;Explicit (x1)" content="                    self._logger.error(f&quot;Exception at {method_reference} of &quot;" number="262" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)&#10;Explicit (x2)" content="                                       f&quot;{method_to_instance[method_reference].get_simple_name()}: {e}&quot;)" number="263" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                    self._logger.error(traceback.format_exc())" number="264" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x4)&#10;Explicit (x2)" content="                    error_in_instances.append(method_to_instance[method_reference].get_simple_name())" number="265" precision="any"/><line any_info="No Anys on this line!" content="                    if break_on_exception:" number="266" precision="precise"/><line any_info="No Anys on this line!" content="                        raise RuntimeError(self.__class__.__name__, error_in_instances)" number="267" precision="precise"/><line any_info="No Anys on this line!" content="" number="268" precision="empty"/><line any_info="No Anys on this line!" content="        if 0 &lt; len(error_in_instances):" number="269" precision="precise"/><line any_info="No Anys on this line!" content="            raise RuntimeError(self.__class__.__name__, error_in_instances)" number="270" precision="precise"/><line any_info="No Anys on this line!" content="" number="271" precision="empty"/><line any_info="No Anys on this line!" content="        return all_instances_finished" number="272" precision="precise"/><line any_info="No Anys on this line!" content="" number="273" precision="empty"/><line any_info="No Anys on this line!" content="    def shutdown(self):" number="274" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self._logger.debug(&quot;Shutting down state: %s&quot;, self.__class__.__name__)" number="275" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        self.__executor.shutdown(wait=True, cancel_futures=True)" number="276" precision="any"/><line any_info="No Anys on this line!" content="" number="277" precision="empty"/><line any_info="No Anys on this line!" content="    # ======== private methods =========" number="278" precision="empty"/><line any_info="No Anys on this line!" content="" number="279" precision="empty"/><line any_info="No Anys on this line!" content="    def __enter_state(self):" number="280" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="        self._logger.info(&quot;(%s)--[%s]--&gt;(%s)&quot;, self._prev_state.__class__.__name__," number="281" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="                          self._reason.__class__.__name__, self.__class__.__name__)" number="282" precision="any"/><line any_info="No Anys on this line!" content="" number="283" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        self._response_collector.clear()" number="284" precision="any"/><line any_info="No Anys on this line!" content="" number="285" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="        self.on_entry()" number="286" precision="any"/><line any_info="No Anys on this line!" content="" number="287" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="        self._state_entry_time_ms = current_time_millis()" number="288" precision="any"/><line any_info="No Anys on this line!" content="" number="289" precision="empty"/><line any_info="No Anys on this line!" content="    def __exit_state(self):" number="290" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="        self.on_exit()" number="291" precision="any"/><line any_info="No Anys on this line!" content="" number="292" precision="empty"/><line any_info="No Anys on this line!" content="" number="293" precision="empty"/><line any_info="No Anys on this line!" content="class StateEntry(State):" number="294" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="295" precision="empty"/><line any_info="No Anys on this line!" content="    Serves as entry point for the state machine." number="296" precision="empty"/><line any_info="No Anys on this line!" content="" number="297" precision="empty"/><line any_info="No Anys on this line!" content="    :param context: :class:`pypz.executors.operator.context.ExecutionContext`" number="298" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="299" precision="empty"/><line any_info="No Anys on this line!" content="" number="300" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="    def __init__(self, context: ExecutionContext, *args, **kwargs):" number="301" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="        super().__init__(context, *args, **kwargs)" number="302" precision="any"/><line any_info="No Anys on this line!" content="" number="303" precision="empty"/><line any_info="No Anys on this line!" content="    def on_entry(self) -&gt; None:" number="304" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="305" precision="precise"/><line any_info="No Anys on this line!" content="" number="306" precision="empty"/><line any_info="No Anys on this line!" content="    def on_exit(self) -&gt; None:" number="307" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="308" precision="precise"/><line any_info="No Anys on this line!" content="" number="309" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def on_execute(self) -&gt; BaseSignal:" number="310" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="        return SignalServicesStart()" number="311" precision="any"/><line any_info="No Anys on this line!" content="" number="312" precision="empty"/><line any_info="No Anys on this line!" content="" number="313" precision="empty"/><line any_info="No Anys on this line!" content="class StateKilled(State):" number="314" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="315" precision="empty"/><line any_info="No Anys on this line!" content="    Serves as exit point for the state machine." number="316" precision="empty"/><line any_info="No Anys on this line!" content="" number="317" precision="empty"/><line any_info="No Anys on this line!" content="    :param context: :class:`pypz.executors.operator.context.ExecutionContext`" number="318" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="319" precision="empty"/><line any_info="No Anys on this line!" content="" number="320" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="    def __init__(self, context: ExecutionContext, *args, **kwargs):" number="321" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="        super().__init__(context, *args, **kwargs)" number="322" precision="any"/><line any_info="No Anys on this line!" content="" number="323" precision="empty"/><line any_info="No Anys on this line!" content="    def on_entry(self) -&gt; None:" number="324" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="325" precision="precise"/><line any_info="No Anys on this line!" content="" number="326" precision="empty"/><line any_info="No Anys on this line!" content="    def on_exit(self) -&gt; None:" number="327" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="328" precision="precise"/><line any_info="No Anys on this line!" content="" number="329" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def on_execute(self) -&gt; BaseSignal:" number="330" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="        return SignalTerminate()" number="331" precision="any"/><line any_info="No Anys on this line!" content="" number="332" precision="empty"/><line any_info="No Anys on this line!" content="" number="333" precision="empty"/><line any_info="No Anys on this line!" content="class StateOperationInit(State):" number="334" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="335" precision="empty"/><line any_info="No Anys on this line!" content="    This state initializes the operator." number="336" precision="empty"/><line any_info="No Anys on this line!" content="" number="337" precision="empty"/><line any_info="No Anys on this line!" content="    Invoked methods:" number="338" precision="empty"/><line any_info="No Anys on this line!" content="" number="339" precision="empty"/><line any_info="No Anys on this line!" content="    1. :meth:`pypz.core.specs.plugin.PortPlugin._on_port_open`" number="340" precision="empty"/><line any_info="No Anys on this line!" content="    2. :meth:`pypz.core.specs.operator.Operator._on_init`" number="341" precision="empty"/><line any_info="No Anys on this line!" content="" number="342" precision="empty"/><line any_info="No Anys on this line!" content="    This order of execution guarantees that the Operator's implementation is already having access" number="343" precision="empty"/><line any_info="No Anys on this line!" content="    to the ports in the init phase." number="344" precision="empty"/><line any_info="No Anys on this line!" content="" number="345" precision="empty"/><line any_info="No Anys on this line!" content="" number="346" precision="empty"/><line any_info="No Anys on this line!" content="    .. note::" number="347" precision="empty"/><line any_info="No Anys on this line!" content="       Note that both the :class:`InputPortPlugin &lt;pypz.core.specs.plugin.InputPortPlugin&gt;` and" number="348" precision="empty"/><line any_info="No Anys on this line!" content="       the :class:`OutputPortPlugin &lt;pypz.core.specs.plugin.OutputPortPlugin&gt;` inherits from the" number="349" precision="empty"/><line any_info="No Anys on this line!" content="       :class:`PortPlugin &lt;pypz.core.specs.plugin.PortPlugin&gt;`, hence plugins of both types will" number="350" precision="empty"/><line any_info="No Anys on this line!" content="       be initialized." number="351" precision="empty"/><line any_info="No Anys on this line!" content="" number="352" precision="empty"/><line any_info="No Anys on this line!" content="    :param context: :class:`pypz.executors.operator.context.ExecutionContext`" number="353" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="354" precision="empty"/><line any_info="No Anys on this line!" content="" number="355" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="    def __init__(self, context: ExecutionContext, *args, **kwargs):" number="356" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="        super().__init__(context, *args, **kwargs)" number="357" precision="any"/><line any_info="No Anys on this line!" content="" number="358" precision="empty"/><line any_info="No Anys on this line!" content="    def on_entry(self) -&gt; None:" number="359" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="360" precision="precise"/><line any_info="No Anys on this line!" content="" number="361" precision="empty"/><line any_info="No Anys on this line!" content="    def on_exit(self) -&gt; None:" number="362" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="363" precision="precise"/><line any_info="No Anys on this line!" content="" number="364" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def on_execute(self) -&gt; BaseSignal:" number="365" precision="any"/><line any_info="No Anys on this line!" content="        try:" number="366" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            if not self._schedule(*[(&quot;_on_port_open&quot;, level)" number="367" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="                                    for level in self._context.get_dependency_graph_by_type(PortPlugin)]," number="368" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                                  (&quot;_on_init&quot;, {self._context.get_operator()})," number="369" precision="any"/><line any_info="No Anys on this line!" content="                                  break_on_exception=True):" number="370" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="                return SignalNoOp()" number="371" precision="any"/><line any_info="No Anys on this line!" content="" number="372" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            return SignalOperationStart()" number="373" precision="any"/><line any_info="No Anys on this line!" content="        except Exception as e:" number="374" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(&quot;========== Exception at execution ==========&quot;)" number="375" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(traceback.format_exc())" number="376" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(&quot;============================================&quot;)" number="377" precision="any"/><line any_info="No Anys on this line!" content="" number="378" precision="empty"/><line any_info="No Anys on this line!" content="            try:" number="379" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x4)" content="                self._schedule((&quot;_on_error&quot;, {self._context.get_operator()})," number="380" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x4)" content="                               (&quot;_on_error&quot;, self._context.get_plugin_instances_by_type(PortPlugin)))" number="381" precision="any"/><line any_info="No Anys on this line!" content="            except Exception as ex:" number="382" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.error(f&quot;Exception at error handling: {ex}&quot;)" number="383" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.error(traceback.format_exc())" number="384" precision="any"/><line any_info="No Anys on this line!" content="" number="385" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="            self._context.set_exit_code(ExitCodes.StateOperationInitError)" number="386" precision="any"/><line any_info="No Anys on this line!" content="" number="387" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            return SignalError(e)" number="388" precision="any"/><line any_info="No Anys on this line!" content="" number="389" precision="empty"/><line any_info="No Anys on this line!" content="" number="390" precision="empty"/><line any_info="No Anys on this line!" content="class StateOperationRunning(State):" number="391" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="392" precision="empty"/><line any_info="No Anys on this line!" content="    This state calls the main processing method of the Operator:" number="393" precision="empty"/><line any_info="No Anys on this line!" content="" number="394" precision="empty"/><line any_info="No Anys on this line!" content="    :meth:`pypz.core.specs.operator.Operator._on_running`" number="395" precision="empty"/><line any_info="No Anys on this line!" content="" number="396" precision="empty"/><line any_info="No Anys on this line!" content="    After successful finish of the Operator's method, the offset commit on all the" number="397" precision="empty"/><line any_info="No Anys on this line!" content="    :class:`InputPortPlugin &lt;pypz.core.specs.plugin.InputPortPlugin&gt;` will be invoked." number="398" precision="empty"/><line any_info="No Anys on this line!" content="" number="399" precision="empty"/><line any_info="No Anys on this line!" content="    :meth:`pypz.core.specs.plugin.InputPortPlugin.commit_current_read_offset`" number="400" precision="empty"/><line any_info="No Anys on this line!" content="" number="401" precision="empty"/><line any_info="No Anys on this line!" content="    This ensures that even, if the developer did not commit offsets manually in the" number="402" precision="empty"/><line any_info="No Anys on this line!" content="    implementation, offsets will still be committed." number="403" precision="empty"/><line any_info="No Anys on this line!" content="" number="404" precision="empty"/><line any_info="No Anys on this line!" content="    :param context: :class:`pypz.executors.operator.context.ExecutionContext`" number="405" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="406" precision="empty"/><line any_info="No Anys on this line!" content="" number="407" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="    def __init__(self, context: ExecutionContext, *args, **kwargs):" number="408" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="        super().__init__(context, *args, **kwargs)" number="409" precision="any"/><line any_info="No Anys on this line!" content="" number="410" precision="empty"/><line any_info="No Anys on this line!" content="    def on_entry(self) -&gt; None:" number="411" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="412" precision="precise"/><line any_info="No Anys on this line!" content="" number="413" precision="empty"/><line any_info="No Anys on this line!" content="    def on_exit(self) -&gt; None:" number="414" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="415" precision="precise"/><line any_info="No Anys on this line!" content="" number="416" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def on_execute(self) -&gt; BaseSignal:" number="417" precision="any"/><line any_info="No Anys on this line!" content="        try:" number="418" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x6)" content="            is_finished = self._context.get_operator()._on_running()" number="419" precision="any"/><line any_info="No Anys on this line!" content="            # TODO - on_running shall be submitted to the executor as well" number="420" precision="empty"/><line any_info="No Anys on this line!" content="            # is_finished = self._schedule((&quot;_on_running&quot;, {self._context.get_operator()}))" number="421" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="            self._schedule((&quot;commit_current_read_offset&quot;, self._context.get_plugin_instances_by_type(InputPortPlugin)))" number="422" precision="any"/><line any_info="No Anys on this line!" content="" number="423" precision="empty"/><line any_info="No Anys on this line!" content="            # If nothing or None is returned from on_running, then it will be automatically" number="424" precision="empty"/><line any_info="No Anys on this line!" content="            # determined, whether to terminate the state or not" number="425" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="            if is_finished is None:" number="426" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="                for input_port_plugin in self._context.get_plugin_instances_by_type(InputPortPlugin):" number="427" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                    if input_port_plugin.can_retrieve():" number="428" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="                        return SignalNoOp()" number="429" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="            elif not is_finished:" number="430" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="                return SignalNoOp()" number="431" precision="any"/><line any_info="No Anys on this line!" content="" number="432" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            return SignalOperationStop()" number="433" precision="any"/><line any_info="No Anys on this line!" content="        except Exception as e:" number="434" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(&quot;========== Exception at execution ==========&quot;)" number="435" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(traceback.format_exc())" number="436" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(&quot;============================================&quot;)" number="437" precision="any"/><line any_info="No Anys on this line!" content="" number="438" precision="empty"/><line any_info="No Anys on this line!" content="            try:" number="439" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x4)" content="                self._schedule((&quot;_on_error&quot;, {self._context.get_operator()})," number="440" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x4)" content="                               (&quot;_on_error&quot;, self._context.get_plugin_instances_by_type(PortPlugin)))" number="441" precision="any"/><line any_info="No Anys on this line!" content="            except Exception as ex:" number="442" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.error(f&quot;Exception at error handling: {ex}&quot;)" number="443" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.error(traceback.format_exc())" number="444" precision="any"/><line any_info="No Anys on this line!" content="" number="445" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="            self._context.set_exit_code(ExitCodes.StateOperationError)" number="446" precision="any"/><line any_info="No Anys on this line!" content="" number="447" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            return SignalError(e)" number="448" precision="any"/><line any_info="No Anys on this line!" content="" number="449" precision="empty"/><line any_info="No Anys on this line!" content="" number="450" precision="empty"/><line any_info="No Anys on this line!" content="class StateOperationShutdown(State):" number="451" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="452" precision="empty"/><line any_info="No Anys on this line!" content="    This state shuts down the operator." number="453" precision="empty"/><line any_info="No Anys on this line!" content="" number="454" precision="empty"/><line any_info="No Anys on this line!" content="    Invoked methods:" number="455" precision="empty"/><line any_info="No Anys on this line!" content="" number="456" precision="empty"/><line any_info="No Anys on this line!" content="    1. :meth:`pypz.core.specs.operator.Operator._on_shutdown`" number="457" precision="empty"/><line any_info="No Anys on this line!" content="    2. :meth:`pypz.core.specs.plugin.PortPlugin._on_port_close`" number="458" precision="empty"/><line any_info="No Anys on this line!" content="" number="459" precision="empty"/><line any_info="No Anys on this line!" content="    This order of execution guarantees that the Operator's implementation is still having access" number="460" precision="empty"/><line any_info="No Anys on this line!" content="    to the ports in the shutdown phase." number="461" precision="empty"/><line any_info="No Anys on this line!" content="" number="462" precision="empty"/><line any_info="No Anys on this line!" content="    .. note::" number="463" precision="empty"/><line any_info="No Anys on this line!" content="       Note that both the :class:`InputPortPlugin &lt;pypz.core.specs.plugin.InputPortPlugin&gt;` and" number="464" precision="empty"/><line any_info="No Anys on this line!" content="       the :class:`OutputPortPlugin &lt;pypz.core.specs.plugin.OutputPortPlugin&gt;` inherits from the" number="465" precision="empty"/><line any_info="No Anys on this line!" content="       :class:`PortPlugin &lt;pypz.core.specs.plugin.PortPlugin&gt;`, hence plugins of both types will" number="466" precision="empty"/><line any_info="No Anys on this line!" content="       be shut down." number="467" precision="empty"/><line any_info="No Anys on this line!" content="" number="468" precision="empty"/><line any_info="No Anys on this line!" content="    :param context: :class:`pypz.executors.operator.context.ExecutionContext`" number="469" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="470" precision="empty"/><line any_info="No Anys on this line!" content="" number="471" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="    def __init__(self, context: ExecutionContext, *args, **kwargs):" number="472" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="        super().__init__(context, *args, **kwargs)" number="473" precision="any"/><line any_info="No Anys on this line!" content="" number="474" precision="empty"/><line any_info="No Anys on this line!" content="    def on_entry(self) -&gt; None:" number="475" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="476" precision="precise"/><line any_info="No Anys on this line!" content="" number="477" precision="empty"/><line any_info="No Anys on this line!" content="    def on_exit(self) -&gt; None:" number="478" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="479" precision="precise"/><line any_info="No Anys on this line!" content="" number="480" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def on_execute(self) -&gt; BaseSignal:" number="481" precision="any"/><line any_info="No Anys on this line!" content="        try:" number="482" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x4)" content="            if not self._schedule((&quot;_on_shutdown&quot;, {self._context.get_operator()})," number="483" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="                                  *[(&quot;_on_port_close&quot;, level)" number="484" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x6)&#10;Omitted Generics (x4)" content="                                    for level in reversed(self._context.get_dependency_graph_by_type(PortPlugin))]):" number="485" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="                return SignalNoOp()" number="486" precision="any"/><line any_info="No Anys on this line!" content="" number="487" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x6)" content="            if ExecutionMode.WithoutResourceDeletion == self._context.get_execution_mode():" number="488" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="                return SignalServicesStop()" number="489" precision="any"/><line any_info="No Anys on this line!" content="" number="490" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            return SignalResourcesDeletion()" number="491" precision="any"/><line any_info="No Anys on this line!" content="        except Exception as e:" number="492" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(&quot;========== Exception at execution ==========&quot;)" number="493" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(traceback.format_exc())" number="494" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(&quot;============================================&quot;)" number="495" precision="any"/><line any_info="No Anys on this line!" content="" number="496" precision="empty"/><line any_info="No Anys on this line!" content="            try:" number="497" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x4)" content="                self._schedule((&quot;_on_error&quot;, {self._context.get_operator()})," number="498" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x4)" content="                               (&quot;_on_error&quot;, self._context.get_plugin_instances_by_type(PortPlugin)))" number="499" precision="any"/><line any_info="No Anys on this line!" content="            except Exception as ex:" number="500" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.error(f&quot;Exception at error handling: {ex}&quot;)" number="501" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.error(traceback.format_exc())" number="502" precision="any"/><line any_info="No Anys on this line!" content="" number="503" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="            self._context.set_exit_code(ExitCodes.StateOperationShutdownError)" number="504" precision="any"/><line any_info="No Anys on this line!" content="" number="505" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            return SignalError(e)" number="506" precision="any"/><line any_info="No Anys on this line!" content="" number="507" precision="empty"/><line any_info="No Anys on this line!" content="" number="508" precision="empty"/><line any_info="No Anys on this line!" content="class StateResourceCreation(State):" number="509" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="510" precision="empty"/><line any_info="No Anys on this line!" content="    This state is responsible to invoke the resource creation related methods." number="511" precision="empty"/><line any_info="No Anys on this line!" content="" number="512" precision="empty"/><line any_info="No Anys on this line!" content="    Invoked methods:" number="513" precision="empty"/><line any_info="No Anys on this line!" content="" number="514" precision="empty"/><line any_info="No Anys on this line!" content="    :meth:`pypz.core.specs.plugin.ResourceHandlerPlugin._on_resource_creation`" number="515" precision="empty"/><line any_info="No Anys on this line!" content="" number="516" precision="empty"/><line any_info="No Anys on this line!" content="    :param context: :class:`pypz.executors.operator.context.ExecutionContext`" number="517" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="518" precision="empty"/><line any_info="No Anys on this line!" content="" number="519" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="    def __init__(self, context: ExecutionContext, *args, **kwargs):" number="520" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="        super().__init__(context, *args, **kwargs)" number="521" precision="any"/><line any_info="No Anys on this line!" content="" number="522" precision="empty"/><line any_info="No Anys on this line!" content="    def on_entry(self) -&gt; None:" number="523" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="524" precision="precise"/><line any_info="No Anys on this line!" content="" number="525" precision="empty"/><line any_info="No Anys on this line!" content="    def on_exit(self) -&gt; None:" number="526" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="527" precision="precise"/><line any_info="No Anys on this line!" content="" number="528" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def on_execute(self) -&gt; BaseSignal:" number="529" precision="any"/><line any_info="No Anys on this line!" content="        try:" number="530" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            if not self._schedule(*[(&quot;_on_resource_creation&quot;, level)" number="531" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="                                    for level in self._context.get_dependency_graph_by_type(ResourceHandlerPlugin)]," number="532" precision="any"/><line any_info="No Anys on this line!" content="                                  break_on_exception=True):" number="533" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="                return SignalNoOp()" number="534" precision="any"/><line any_info="No Anys on this line!" content="" number="535" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x6)" content="            if ExecutionMode.ResourceCreationOnly == self._context.get_execution_mode():" number="536" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="                return SignalServicesStop()" number="537" precision="any"/><line any_info="No Anys on this line!" content="" number="538" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            return SignalOperationInit()" number="539" precision="any"/><line any_info="No Anys on this line!" content="        except Exception as e:" number="540" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(&quot;========== Exception at execution ==========&quot;)" number="541" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(traceback.format_exc())" number="542" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(&quot;============================================&quot;)" number="543" precision="any"/><line any_info="No Anys on this line!" content="" number="544" precision="empty"/><line any_info="No Anys on this line!" content="            try:" number="545" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="                self._schedule((&quot;_on_error&quot;, self._context.get_plugin_instances_by_type(ResourceHandlerPlugin)))" number="546" precision="any"/><line any_info="No Anys on this line!" content="            except Exception as ex:" number="547" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.error(f&quot;Exception at error handling: {ex}&quot;)" number="548" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.error(traceback.format_exc())" number="549" precision="any"/><line any_info="No Anys on this line!" content="" number="550" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="            self._context.set_exit_code(ExitCodes.StateResourceCreationError)" number="551" precision="any"/><line any_info="No Anys on this line!" content="" number="552" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            return SignalError(e)" number="553" precision="any"/><line any_info="No Anys on this line!" content="" number="554" precision="empty"/><line any_info="No Anys on this line!" content="" number="555" precision="empty"/><line any_info="No Anys on this line!" content="class StateResourceDeletion(State):" number="556" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="557" precision="empty"/><line any_info="No Anys on this line!" content="    This state is responsible to invoke the resource deletion related methods." number="558" precision="empty"/><line any_info="No Anys on this line!" content="" number="559" precision="empty"/><line any_info="No Anys on this line!" content="    Invoked methods:" number="560" precision="empty"/><line any_info="No Anys on this line!" content="" number="561" precision="empty"/><line any_info="No Anys on this line!" content="    :meth:`pypz.core.specs.plugin.ResourceHandlerPlugin._on_resource_deletion`" number="562" precision="empty"/><line any_info="No Anys on this line!" content="" number="563" precision="empty"/><line any_info="No Anys on this line!" content="    :param context: :class:`pypz.executors.operator.context.ExecutionContext`" number="564" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="565" precision="empty"/><line any_info="No Anys on this line!" content="" number="566" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="    def __init__(self, context: ExecutionContext, *args, **kwargs):" number="567" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="        super().__init__(context, *args, **kwargs)" number="568" precision="any"/><line any_info="No Anys on this line!" content="" number="569" precision="empty"/><line any_info="No Anys on this line!" content="    def on_entry(self) -&gt; None:" number="570" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="571" precision="precise"/><line any_info="No Anys on this line!" content="" number="572" precision="empty"/><line any_info="No Anys on this line!" content="    def on_exit(self) -&gt; None:" number="573" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="574" precision="precise"/><line any_info="No Anys on this line!" content="" number="575" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def on_execute(self) -&gt; BaseSignal:" number="576" precision="any"/><line any_info="No Anys on this line!" content="        try:" number="577" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            if not self._schedule(*[(&quot;_on_resource_deletion&quot;, level) for level in" number="578" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x5)&#10;Omitted Generics (x4)" content="                                    reversed(self._context.get_dependency_graph_by_type(ResourceHandlerPlugin))]):" number="579" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="                return SignalNoOp()" number="580" precision="any"/><line any_info="No Anys on this line!" content="" number="581" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            return SignalServicesStop()" number="582" precision="any"/><line any_info="No Anys on this line!" content="        except Exception as e:" number="583" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(&quot;========== Exception at execution ==========&quot;)" number="584" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(traceback.format_exc())" number="585" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(&quot;============================================&quot;)" number="586" precision="any"/><line any_info="No Anys on this line!" content="" number="587" precision="empty"/><line any_info="No Anys on this line!" content="            try:" number="588" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="                self._schedule((&quot;_on_error&quot;, self._context.get_plugin_instances_by_type(ResourceHandlerPlugin)))" number="589" precision="any"/><line any_info="No Anys on this line!" content="            except Exception as ex:" number="590" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.error(f&quot;Exception at error handling: {ex}&quot;)" number="591" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.error(traceback.format_exc())" number="592" precision="any"/><line any_info="No Anys on this line!" content="" number="593" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="            self._context.set_exit_code(ExitCodes.StateResourcesDeletionError)" number="594" precision="any"/><line any_info="No Anys on this line!" content="" number="595" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            return SignalError(e)" number="596" precision="any"/><line any_info="No Anys on this line!" content="" number="597" precision="empty"/><line any_info="No Anys on this line!" content="" number="598" precision="empty"/><line any_info="No Anys on this line!" content="class StateServiceStart(State):" number="599" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="600" precision="empty"/><line any_info="No Anys on this line!" content="    This state is responsible to invoke the service start related methods." number="601" precision="empty"/><line any_info="No Anys on this line!" content="" number="602" precision="empty"/><line any_info="No Anys on this line!" content="    Invoked methods:" number="603" precision="empty"/><line any_info="No Anys on this line!" content="" number="604" precision="empty"/><line any_info="No Anys on this line!" content="    :meth:`pypz.core.specs.plugin.ServicePlugin._on_service_start`" number="605" precision="empty"/><line any_info="No Anys on this line!" content="" number="606" precision="empty"/><line any_info="No Anys on this line!" content="    :param context: :class:`pypz.executors.operator.context.ExecutionContext`" number="607" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="608" precision="empty"/><line any_info="No Anys on this line!" content="" number="609" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="    def __init__(self, context: ExecutionContext, *args, **kwargs):" number="610" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="        super().__init__(context, *args, **kwargs)" number="611" precision="any"/><line any_info="No Anys on this line!" content="" number="612" precision="empty"/><line any_info="No Anys on this line!" content="    def on_entry(self) -&gt; None:" number="613" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="614" precision="precise"/><line any_info="No Anys on this line!" content="" number="615" precision="empty"/><line any_info="No Anys on this line!" content="    def on_exit(self) -&gt; None:" number="616" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="617" precision="precise"/><line any_info="No Anys on this line!" content="" number="618" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def on_execute(self) -&gt; BaseSignal:" number="619" precision="any"/><line any_info="No Anys on this line!" content="        try:" number="620" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            if not self._schedule(*[(&quot;_on_service_start&quot;, level)" number="621" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="                                    for level in self._context.get_dependency_graph_by_type(ServicePlugin)]," number="622" precision="any"/><line any_info="No Anys on this line!" content="                                  break_on_exception=True):" number="623" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="                return SignalNoOp()" number="624" precision="any"/><line any_info="No Anys on this line!" content="" number="625" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x6)" content="            if ExecutionMode.ResourceDeletionOnly == self._context.get_execution_mode():" number="626" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="                return SignalResourcesDeletion()" number="627" precision="any"/><line any_info="No Anys on this line!" content="" number="628" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            return SignalResourcesCreation()" number="629" precision="any"/><line any_info="No Anys on this line!" content="        except Exception as e:" number="630" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(&quot;========== Exception at execution ==========&quot;)" number="631" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(traceback.format_exc())" number="632" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(&quot;============================================&quot;)" number="633" precision="any"/><line any_info="No Anys on this line!" content="" number="634" precision="empty"/><line any_info="No Anys on this line!" content="            try:" number="635" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="                self._schedule((&quot;_on_error&quot;, self._context.get_plugin_instances_by_type(ServicePlugin)))" number="636" precision="any"/><line any_info="No Anys on this line!" content="            except Exception as ex:" number="637" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.error(f&quot;Exception at error handling: {ex}&quot;)" number="638" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.error(traceback.format_exc())" number="639" precision="any"/><line any_info="No Anys on this line!" content="" number="640" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="            self._context.set_exit_code(ExitCodes.StateServiceStartError)" number="641" precision="any"/><line any_info="No Anys on this line!" content="" number="642" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            return SignalError(e)" number="643" precision="any"/><line any_info="No Anys on this line!" content="" number="644" precision="empty"/><line any_info="No Anys on this line!" content="" number="645" precision="empty"/><line any_info="No Anys on this line!" content="class StateServiceShutdown(State):" number="646" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="647" precision="empty"/><line any_info="No Anys on this line!" content="    This state is responsible to invoke the service shutdown related methods." number="648" precision="empty"/><line any_info="No Anys on this line!" content="" number="649" precision="empty"/><line any_info="No Anys on this line!" content="    Invoked methods:" number="650" precision="empty"/><line any_info="No Anys on this line!" content="" number="651" precision="empty"/><line any_info="No Anys on this line!" content="    :meth:`pypz.core.specs.plugin.ServicePlugin._on_service_shutdown`" number="652" precision="empty"/><line any_info="No Anys on this line!" content="" number="653" precision="empty"/><line any_info="No Anys on this line!" content="    :param context: :class:`pypz.executors.operator.context.ExecutionContext`" number="654" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="655" precision="empty"/><line any_info="No Anys on this line!" content="" number="656" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="    def __init__(self, context: ExecutionContext, *args, **kwargs):" number="657" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x1)&#10;Unannotated (x2)" content="        super().__init__(context, *args, **kwargs)" number="658" precision="any"/><line any_info="No Anys on this line!" content="" number="659" precision="empty"/><line any_info="No Anys on this line!" content="    def on_entry(self) -&gt; None:" number="660" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="661" precision="precise"/><line any_info="No Anys on this line!" content="" number="662" precision="empty"/><line any_info="No Anys on this line!" content="    def on_exit(self) -&gt; None:" number="663" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="664" precision="precise"/><line any_info="No Anys on this line!" content="" number="665" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def on_execute(self) -&gt; BaseSignal:" number="666" precision="any"/><line any_info="No Anys on this line!" content="        try:" number="667" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            if not self._schedule(*[(&quot;_on_service_shutdown&quot;, level)" number="668" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x6)&#10;Omitted Generics (x4)" content="                                    for level in reversed(self._context.get_dependency_graph_by_type(ServicePlugin))]):" number="669" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="                return SignalNoOp()" number="670" precision="any"/><line any_info="No Anys on this line!" content="" number="671" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            return SignalKill()" number="672" precision="any"/><line any_info="No Anys on this line!" content="        except:  # noqa: E722" number="673" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(&quot;========== Exception at execution ==========&quot;)" number="674" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(traceback.format_exc())" number="675" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self._logger.error(&quot;============================================&quot;)" number="676" precision="any"/><line any_info="No Anys on this line!" content="" number="677" precision="empty"/><line any_info="No Anys on this line!" content="            try:" number="678" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="                self._schedule((&quot;_on_error&quot;, self._context.get_plugin_instances_by_type(ServicePlugin)))" number="679" precision="any"/><line any_info="No Anys on this line!" content="            except Exception as ex:" number="680" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.error(f&quot;Exception at error handling: {ex}&quot;)" number="681" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="                self._logger.error(traceback.format_exc())" number="682" precision="any"/><line any_info="No Anys on this line!" content="" number="683" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="            self._context.set_exit_code(ExitCodes.StateServiceShutdownError)" number="684" precision="any"/><line any_info="No Anys on this line!" content="" number="685" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="            return SignalKill()" number="686" precision="any"/></mypy-report-file>