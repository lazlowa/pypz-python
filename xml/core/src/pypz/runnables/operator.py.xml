<?xml-stylesheet type="text/xsl" href="../../../../../mypy-html.xslt"?><mypy-report-file name="core\src\pypz\runnables\operator.py" module="core.src.pypz.runnables.operator"><line any_info="No Anys on this line!" content="# =============================================================================" number="1" precision="empty"/><line any_info="No Anys on this line!" content="# Copyright (c) 2024 by Laszlo Anka. All rights reserved." number="2" precision="empty"/><line any_info="No Anys on this line!" content="#" number="3" precision="empty"/><line any_info="No Anys on this line!" content="# Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);" number="4" precision="empty"/><line any_info="No Anys on this line!" content="# you may not use this file except in compliance with the License." number="5" precision="empty"/><line any_info="No Anys on this line!" content="# You may obtain a copy of the License at" number="6" precision="empty"/><line any_info="No Anys on this line!" content="#" number="7" precision="empty"/><line any_info="No Anys on this line!" content="#     http://www.apache.org/licenses/LICENSE-2.0" number="8" precision="empty"/><line any_info="No Anys on this line!" content="#" number="9" precision="empty"/><line any_info="No Anys on this line!" content="# Unless required by applicable law or agreed to in writing, software" number="10" precision="empty"/><line any_info="No Anys on this line!" content="# distributed under the License is distributed on an &quot;AS IS&quot; BASIS," number="11" precision="empty"/><line any_info="No Anys on this line!" content="# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied." number="12" precision="empty"/><line any_info="No Anys on this line!" content="# See the License for the specific language governing permissions and" number="13" precision="empty"/><line any_info="No Anys on this line!" content="# limitations under the License." number="14" precision="empty"/><line any_info="No Anys on this line!" content="# =============================================================================" number="15" precision="empty"/><line any_info="No Anys on this line!" content="import sys" number="16" precision="precise"/><line any_info="No Anys on this line!" content="" number="17" precision="empty"/><line any_info="No Anys on this line!" content="import yaml" number="18" precision="precise"/><line any_info="No Anys on this line!" content="" number="19" precision="empty"/><line any_info="No Anys on this line!" content="from pypz.core.specs.dtos import PipelineInstanceDTO" number="20" precision="any"/><line any_info="No Anys on this line!" content="from pypz.core.specs.operator import Operator" number="21" precision="any"/><line any_info="No Anys on this line!" content="from pypz.core.specs.pipeline import Pipeline" number="22" precision="any"/><line any_info="No Anys on this line!" content="from pypz.executors.commons import ExecutionMode" number="23" precision="any"/><line any_info="No Anys on this line!" content="from pypz.executors.operator.executor import OperatorExecutor" number="24" precision="any"/><line any_info="No Anys on this line!" content="" number="25" precision="empty"/><line any_info="No Anys on this line!" content="&quot;&quot;&quot; This script is used to invoke operator execution &quot;&quot;&quot;" number="26" precision="empty"/><line any_info="No Anys on this line!" content="if __name__ == &quot;__main__&quot;:" number="27" precision="precise"/><line any_info="No Anys on this line!" content="    print(sys.argv)" number="28" precision="precise"/><line any_info="No Anys on this line!" content="    if 3 &gt; len(sys.argv):" number="29" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="        print(&quot;Missing arguments:\n&quot;" number="30" precision="any"/><line any_info="No Anys on this line!" content="              &quot;$1 - path to config file\n&quot;" number="31" precision="empty"/><line any_info="No Anys on this line!" content="              &quot;$2 - operator simple name\n&quot;" number="32" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="              f&quot;$3 - [Optional] ExecutionMode (default: {ExecutionMode.Standard.name}). &quot;" number="33" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x4)" content="              f&quot;Possible values: {[elem.name for elem in ExecutionMode]}&quot;," number="34" precision="any"/><line any_info="No Anys on this line!" content="              file=sys.stderr)" number="35" precision="precise"/><line any_info="No Anys on this line!" content="        sys.exit(1)" number="36" precision="precise"/><line any_info="No Anys on this line!" content="" number="37" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x7)&#10;Explicit (x1)" content="    with open(sys.argv[1]) as json_file:" number="38" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x4)&#10;Explicit (x2)" content="        pipeline_dto: PipelineInstanceDTO = PipelineInstanceDTO(**yaml.safe_load(json_file))" number="39" precision="any"/><line any_info="No Anys on this line!" content="" number="40" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x6)" content="        pipeline: Pipeline = Pipeline.create_from_dto(pipeline_dto, mock_nonexistent=True)" number="41" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x7)" content="        operator: Operator = pipeline.get_protected().get_nested_instance(sys.argv[2])" number="42" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x6)" content="        exec_mode: ExecutionMode = ExecutionMode.Standard if 4 &gt; len(sys.argv) else ExecutionMode(sys.argv[3])" number="43" precision="any"/><line any_info="No Anys on this line!" content="" number="44" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="        print(f&quot;Operator to execute: {operator.get_full_name()}; Execution mode: {exec_mode.name}&quot;)" number="45" precision="any"/><line any_info="No Anys on this line!" content="" number="46" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="        executor: OperatorExecutor = OperatorExecutor(operator)" number="47" precision="any"/><line any_info="No Anys on this line!" content="" number="48" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="        exit_code = executor.execute(exec_mode)" number="49" precision="any"/><line any_info="No Anys on this line!" content="" number="50" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="        sys.exit(exit_code)" number="51" precision="any"/></mypy-report-file>