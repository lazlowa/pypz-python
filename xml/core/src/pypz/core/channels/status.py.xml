<?xml-stylesheet type="text/xsl" href="../../../../../../mypy-html.xslt"?><mypy-report-file name="core\src\pypz\core\channels\status.py" module="core.src.pypz.core.channels.status"><line any_info="No Anys on this line!" content="# =============================================================================" number="1" precision="empty"/><line any_info="No Anys on this line!" content="# Copyright (c) 2024 by Laszlo Anka. All rights reserved." number="2" precision="empty"/><line any_info="No Anys on this line!" content="#" number="3" precision="empty"/><line any_info="No Anys on this line!" content="# Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);" number="4" precision="empty"/><line any_info="No Anys on this line!" content="# you may not use this file except in compliance with the License." number="5" precision="empty"/><line any_info="No Anys on this line!" content="# You may obtain a copy of the License at" number="6" precision="empty"/><line any_info="No Anys on this line!" content="#" number="7" precision="empty"/><line any_info="No Anys on this line!" content="#     http://www.apache.org/licenses/LICENSE-2.0" number="8" precision="empty"/><line any_info="No Anys on this line!" content="#" number="9" precision="empty"/><line any_info="No Anys on this line!" content="# Unless required by applicable law or agreed to in writing, software" number="10" precision="empty"/><line any_info="No Anys on this line!" content="# distributed under the License is distributed on an &quot;AS IS&quot; BASIS," number="11" precision="empty"/><line any_info="No Anys on this line!" content="# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied." number="12" precision="empty"/><line any_info="No Anys on this line!" content="# See the License for the specific language governing permissions and" number="13" precision="empty"/><line any_info="No Anys on this line!" content="# limitations under the License." number="14" precision="empty"/><line any_info="No Anys on this line!" content="# =============================================================================" number="15" precision="empty"/><line any_info="No Anys on this line!" content="import json" number="16" precision="precise"/><line any_info="No Anys on this line!" content="from enum import Enum" number="17" precision="precise"/><line any_info="No Anys on this line!" content="" number="18" precision="empty"/><line any_info="No Anys on this line!" content="from typing import Callable, Any, Optional" number="19" precision="precise"/><line any_info="No Anys on this line!" content="" number="20" precision="empty"/><line any_info="No Anys on this line!" content="from pypz.core.commons.loggers import ContextLogger, DefaultContextLogger" number="21" precision="any"/><line any_info="No Anys on this line!" content="from pypz.core.commons.utils import current_time_millis" number="22" precision="any"/><line any_info="No Anys on this line!" content="" number="23" precision="empty"/><line any_info="No Anys on this line!" content="" number="24" precision="empty"/><line any_info="No Anys on this line!" content="NameSeparator = &quot;@&quot;" number="25" precision="precise"/><line any_info="No Anys on this line!" content="&quot;&quot;&quot;" number="26" precision="empty"/><line any_info="No Anys on this line!" content="Used to construct channel unique name" number="27" precision="empty"/><line any_info="No Anys on this line!" content="&quot;&quot;&quot;" number="28" precision="empty"/><line any_info="No Anys on this line!" content="" number="29" precision="empty"/><line any_info="No Anys on this line!" content="" number="30" precision="empty"/><line any_info="No Anys on this line!" content="class ChannelFilter:" number="31" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="32" precision="empty"/><line any_info="No Anys on this line!" content="    This interface contains the methods that shall implement the checking of different" number="33" precision="empty"/><line any_info="No Anys on this line!" content="    statuses. This interface can be used to restrict access to ChannelStatusMonitor" number="34" precision="empty"/><line any_info="No Anys on this line!" content="    object." number="35" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="36" precision="empty"/><line any_info="No Anys on this line!" content="" number="37" precision="empty"/><line any_info="No Anys on this line!" content="    def is_channel_not_initialised(self) -&gt; bool:" number="38" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="39" precision="precise"/><line any_info="No Anys on this line!" content="" number="40" precision="empty"/><line any_info="No Anys on this line!" content="    def is_channel_opened(self) -&gt; bool:" number="41" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="42" precision="precise"/><line any_info="No Anys on this line!" content="" number="43" precision="empty"/><line any_info="No Anys on this line!" content="    def is_channel_started(self) -&gt; bool:" number="44" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="45" precision="precise"/><line any_info="No Anys on this line!" content="" number="46" precision="empty"/><line any_info="No Anys on this line!" content="    def is_channel_stopped(self) -&gt; bool:" number="47" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="48" precision="precise"/><line any_info="No Anys on this line!" content="" number="49" precision="empty"/><line any_info="No Anys on this line!" content="    def is_channel_closed(self) -&gt; bool:" number="50" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="51" precision="precise"/><line any_info="No Anys on this line!" content="" number="52" precision="empty"/><line any_info="No Anys on this line!" content="    def is_channel_error(self) -&gt; bool:" number="53" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="54" precision="precise"/><line any_info="No Anys on this line!" content="" number="55" precision="empty"/><line any_info="No Anys on this line!" content="    def is_channel_healthy(self) -&gt; bool:" number="56" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="57" precision="precise"/><line any_info="No Anys on this line!" content="" number="58" precision="empty"/><line any_info="No Anys on this line!" content="    def get_channel_unique_name(self) -&gt; str:" number="59" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="60" precision="precise"/><line any_info="No Anys on this line!" content="" number="61" precision="empty"/><line any_info="No Anys on this line!" content="    def get_channel_context_name(self) -&gt; str:" number="62" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="63" precision="precise"/><line any_info="No Anys on this line!" content="" number="64" precision="empty"/><line any_info="No Anys on this line!" content="    def get_channel_group_name(self) -&gt; str:" number="65" precision="precise"/><line any_info="No Anys on this line!" content="        pass" number="66" precision="precise"/><line any_info="No Anys on this line!" content="" number="67" precision="empty"/><line any_info="No Anys on this line!" content="" number="68" precision="empty"/><line any_info="No Anys on this line!" content="class ChannelStatus(Enum):" number="69" precision="precise"/><line any_info="No Anys on this line!" content="    Opened = &quot;Opened&quot;" number="70" precision="precise"/><line any_info="No Anys on this line!" content="    Started = &quot;Started&quot;" number="71" precision="precise"/><line any_info="No Anys on this line!" content="    Stopped = &quot;Stopped&quot;" number="72" precision="precise"/><line any_info="No Anys on this line!" content="    Closed = &quot;Closed&quot;" number="73" precision="precise"/><line any_info="No Anys on this line!" content="    HealthCheck = &quot;HealthCheck&quot;" number="74" precision="precise"/><line any_info="No Anys on this line!" content="    Error = &quot;Error&quot;" number="75" precision="precise"/><line any_info="No Anys on this line!" content="    WaitingForSchema = &quot;WaitingForSchema&quot;" number="76" precision="precise"/><line any_info="No Anys on this line!" content="    Acknowledged = &quot;Acknowledged&quot;" number="77" precision="precise"/><line any_info="No Anys on this line!" content="" number="78" precision="empty"/><line any_info="No Anys on this line!" content="" number="79" precision="empty"/><line any_info="No Anys on this line!" content="class ChannelStatusMessage:" number="80" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="81" precision="empty"/><line any_info="No Anys on this line!" content="    This class is a Data Transfer Object (DTO) for the status messages sent between the channels." number="82" precision="empty"/><line any_info="No Anys on this line!" content="" number="83" precision="empty"/><line any_info="No Anys on this line!" content="    :param channel_name: name of the channel" number="84" precision="empty"/><line any_info="No Anys on this line!" content="    :param channel_context_name: name of the context of the channel, which is the full name of the plugin" number="85" precision="empty"/><line any_info="No Anys on this line!" content="    :param channel_group_name: name of the group of the channel, which is the group name of the plugin" number="86" precision="empty"/><line any_info="No Anys on this line!" content="    :param channel_group_index: index of the operator in the group, which is inherited by the plugin" number="87" precision="empty"/><line any_info="No Anys on this line!" content="    :param status: status" number="88" precision="empty"/><line any_info="No Anys on this line!" content="    :param payload: optional payload" number="89" precision="empty"/><line any_info="No Anys on this line!" content="    :param timestamp: timestamp of the message at creation" number="90" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="91" precision="empty"/><line any_info="No Anys on this line!" content="" number="92" precision="empty"/><line any_info="Any Types on this line: &#10;Explicit (x1)" content="    def __init__(self," number="93" precision="imprecise"/><line any_info="No Anys on this line!" content="                 channel_name: str," number="94" precision="empty"/><line any_info="No Anys on this line!" content="                 channel_context_name: str," number="95" precision="empty"/><line any_info="No Anys on this line!" content="                 channel_group_name: str = None," number="96" precision="precise"/><line any_info="No Anys on this line!" content="                 channel_group_index: int = 0," number="97" precision="precise"/><line any_info="No Anys on this line!" content="                 status: ChannelStatus | str = None," number="98" precision="precise"/><line any_info="No Anys on this line!" content="                 payload: Any = None," number="99" precision="precise"/><line any_info="No Anys on this line!" content="                 timestamp: int = None):" number="100" precision="precise"/><line any_info="No Anys on this line!" content="        self.channel_name: str = channel_name" number="101" precision="precise"/><line any_info="No Anys on this line!" content="        self.channel_context_name: str = channel_context_name" number="102" precision="precise"/><line any_info="No Anys on this line!" content="        self.channel_group_name: str = channel_group_name" number="103" precision="precise"/><line any_info="No Anys on this line!" content="        self.channel_group_index: int = channel_group_index" number="104" precision="precise"/><line any_info="No Anys on this line!" content="        self.status: ChannelStatus = status if isinstance(status, ChannelStatus) else ChannelStatus[status]" number="105" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x3)" content="        self.payload: Any = payload" number="106" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="        self.timestamp: int = timestamp if timestamp is not None else current_time_millis()" number="107" precision="any"/><line any_info="No Anys on this line!" content="" number="108" precision="empty"/><line any_info="No Anys on this line!" content="    def get_channel_unique_name(self):" number="109" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x8)" content="        return f&quot;{self.channel_name}@{self.channel_context_name}&quot;" number="110" precision="any"/><line any_info="No Anys on this line!" content="" number="111" precision="empty"/><line any_info="No Anys on this line!" content="    @staticmethod" number="112" precision="empty"/><line any_info="No Anys on this line!" content="    def create_from_json(source):" number="113" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="        if isinstance(source, str):" number="114" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Explicit (x12)" content="            return ChannelStatusMessage(**json.loads(source))" number="115" precision="any"/><line any_info="No Anys on this line!" content="" number="116" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Omitted Generics (x18)" content="        if isinstance(source, dict):" number="117" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)&#10;Explicit (x1)" content="            return ChannelStatusMessage(**source)" number="118" precision="any"/><line any_info="No Anys on this line!" content="" number="119" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)&#10;Explicit (x2)" content="        raise TypeError(&quot;Invalid data type provided for json conversion: &quot; + str(type(source)))" number="120" precision="any"/><line any_info="No Anys on this line!" content="" number="121" precision="empty"/><line any_info="No Anys on this line!" content="    def __str__(self):" number="122" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)&#10;Explicit (x4)" content="        return json.dumps(self," number="123" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)&#10;Omitted Generics (x3)" content="                          default=lambda k: list(k)" number="124" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)&#10;Omitted Generics (x3)" content="                          if isinstance(k, set) else" number="125" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="                          k.__dict__ if not isinstance(k, Enum) else k.value)" number="126" precision="any"/><line any_info="No Anys on this line!" content="" number="127" precision="empty"/><line any_info="No Anys on this line!" content="" number="128" precision="empty"/><line any_info="No Anys on this line!" content="class ChannelStatusMonitor(ChannelFilter):" number="129" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="130" precision="empty"/><line any_info="No Anys on this line!" content="    This class has the responsibility to monitor and track state of the connected channel RW entities." number="131" precision="empty"/><line any_info="No Anys on this line!" content="    If the counterpart sends a status message, this class has to parse and interpret it. In addition," number="132" precision="empty"/><line any_info="No Anys on this line!" content="    it provides an implementation for the ``ChannelFilter`` interface to enable certain queries." number="133" precision="empty"/><line any_info="No Anys on this line!" content="" number="134" precision="empty"/><line any_info="No Anys on this line!" content="    :param channel_name: name of the channel" number="135" precision="empty"/><line any_info="No Anys on this line!" content="    :param channel_context_name: name of the context of the channel, which is the full name of the plugin" number="136" precision="empty"/><line any_info="No Anys on this line!" content="    :param channel_group_name: name of the group of the channel, which is the group name of the plugin" number="137" precision="empty"/><line any_info="No Anys on this line!" content="    :param logger: the context logger of the plugin, which is inherited from the operator" number="138" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="139" precision="empty"/><line any_info="No Anys on this line!" content="" number="140" precision="empty"/><line any_info="No Anys on this line!" content="    ValidPatienceTimeInMs = 120000" number="141" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="142" precision="empty"/><line any_info="No Anys on this line!" content="    This is the patience time for not receiving any update from the ChannelReader. Once this time" number="143" precision="empty"/><line any_info="No Anys on this line!" content="    is up, the ChannelReader will be invalidated" number="144" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="145" precision="empty"/><line any_info="No Anys on this line!" content="" number="146" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def __init__(self," number="147" precision="imprecise"/><line any_info="No Anys on this line!" content="                 channel_name: str," number="148" precision="empty"/><line any_info="No Anys on this line!" content="                 channel_context_name: str," number="149" precision="empty"/><line any_info="No Anys on this line!" content="                 channel_group_name: str = None," number="150" precision="precise"/><line any_info="No Anys on this line!" content="                 logger: ContextLogger = None):" number="151" precision="precise"/><line any_info="No Anys on this line!" content="        self.channel_name: str = channel_name" number="152" precision="precise"/><line any_info="No Anys on this line!" content="" number="153" precision="empty"/><line any_info="No Anys on this line!" content="        self.channel_context_name: str = channel_context_name" number="154" precision="precise"/><line any_info="No Anys on this line!" content="" number="155" precision="empty"/><line any_info="No Anys on this line!" content="        self.channel_group_name: str = channel_group_name" number="156" precision="precise"/><line any_info="No Anys on this line!" content="" number="157" precision="empty"/><line any_info="No Anys on this line!" content="        self.status_update_map: dict[ChannelStatus, int] = dict()" number="158" precision="precise"/><line any_info="No Anys on this line!" content="" number="159" precision="empty"/><line any_info="No Anys on this line!" content="        self.current_status: Optional[ChannelStatus] = None" number="160" precision="precise"/><line any_info="No Anys on this line!" content="" number="161" precision="empty"/><line any_info="No Anys on this line!" content="        self.last_status_change_timestamp_ms: int = 0" number="162" precision="precise"/><line any_info="No Anys on this line!" content="" number="163" precision="empty"/><line any_info="No Anys on this line!" content="        self.last_update_sent_timestamp_ms: int = 0" number="164" precision="precise"/><line any_info="No Anys on this line!" content="" number="165" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="        self.monitor_start_timestamp: int = current_time_millis()" number="166" precision="any"/><line any_info="No Anys on this line!" content="" number="167" precision="empty"/><line any_info="No Anys on this line!" content="        self.status_update_callback: Optional[Callable[[ChannelStatusMessage], None]] = None" number="168" precision="precise"/><line any_info="No Anys on this line!" content="" number="169" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="        self.logger: ContextLogger = \" number="170" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x6)" content="            ContextLogger(logger, *logger.get_context_stack(), channel_context_name) \" number="171" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="            if logger is not None else ContextLogger(DefaultContextLogger(self.get_channel_unique_name()))" number="172" precision="any"/><line any_info="No Anys on this line!" content="" number="173" precision="empty"/><line any_info="No Anys on this line!" content="    def get_channel_unique_name(self) -&gt; str:" number="174" precision="precise"/><line any_info="No Anys on this line!" content="        return f&quot;{self.channel_name}{NameSeparator}{self.channel_context_name}&quot;" number="175" precision="precise"/><line any_info="No Anys on this line!" content="" number="176" precision="empty"/><line any_info="No Anys on this line!" content="    def get_channel_context_name(self) -&gt; str:" number="177" precision="precise"/><line any_info="No Anys on this line!" content="        return self.channel_context_name" number="178" precision="precise"/><line any_info="No Anys on this line!" content="" number="179" precision="empty"/><line any_info="No Anys on this line!" content="    def get_channel_group_name(self) -&gt; str:" number="180" precision="precise"/><line any_info="No Anys on this line!" content="        return self.channel_group_name" number="181" precision="precise"/><line any_info="No Anys on this line!" content="" number="182" precision="empty"/><line any_info="No Anys on this line!" content="    def is_channel_healthy(self) -&gt; bool:" number="183" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="        return ChannelStatusMonitor.ValidPatienceTimeInMs &gt; (current_time_millis() - self.monitor_start_timestamp) \" number="184" precision="any"/><line any_info="No Anys on this line!" content="            if 0 == self.last_update_sent_timestamp_ms else \" number="185" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x5)" content="            ChannelStatusMonitor.ValidPatienceTimeInMs &gt; (current_time_millis() - self.last_update_sent_timestamp_ms)" number="186" precision="any"/><line any_info="No Anys on this line!" content="" number="187" precision="empty"/><line any_info="No Anys on this line!" content="    def is_channel_not_initialised(self):" number="188" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        return self.current_status is None" number="189" precision="any"/><line any_info="No Anys on this line!" content="" number="190" precision="empty"/><line any_info="No Anys on this line!" content="    def is_channel_opened(self):" number="191" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        return self.current_status == ChannelStatus.Opened" number="192" precision="any"/><line any_info="No Anys on this line!" content="" number="193" precision="empty"/><line any_info="No Anys on this line!" content="    def is_channel_closed(self):" number="194" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        return self.current_status == ChannelStatus.Closed" number="195" precision="any"/><line any_info="No Anys on this line!" content="" number="196" precision="empty"/><line any_info="No Anys on this line!" content="    def is_channel_started(self):" number="197" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        return self.current_status == ChannelStatus.Started" number="198" precision="any"/><line any_info="No Anys on this line!" content="" number="199" precision="empty"/><line any_info="No Anys on this line!" content="    def is_channel_stopped(self):" number="200" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        return self.current_status == ChannelStatus.Stopped" number="201" precision="any"/><line any_info="No Anys on this line!" content="" number="202" precision="empty"/><line any_info="No Anys on this line!" content="    def is_channel_error(self):" number="203" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        return self.current_status == ChannelStatus.Error" number="204" precision="any"/><line any_info="No Anys on this line!" content="" number="205" precision="empty"/><line any_info="Any Types on this line: &#10;Omitted Generics (x3)&#10;Unannotated (x1)" content="    def on_status_update(self, statusUpdateCallback: Callable):" number="206" precision="any"/><line any_info="Any Types on this line: &#10;Omitted Generics (x3)" content="        self.status_update_callback = statusUpdateCallback" number="207" precision="precise"/><line any_info="No Anys on this line!" content="" number="208" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="    def update(self, status_message: ChannelStatusMessage):" number="209" precision="any"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="210" precision="empty"/><line any_info="No Anys on this line!" content="        This method implements the logic to handle status message updates." number="211" precision="empty"/><line any_info="No Anys on this line!" content="        Note that to overcome messaging issues e.g., missing status update," number="212" precision="empty"/><line any_info="No Anys on this line!" content="        we don't introduce a state machine. It means that most of the states" number="213" precision="empty"/><line any_info="No Anys on this line!" content="        can overwrite the actual state with one exception. If &quot;error&quot; status" number="214" precision="empty"/><line any_info="No Anys on this line!" content="        has been sent, it can only be overwritten by &quot;open&quot; or &quot;start&quot;. This" number="215" precision="empty"/><line any_info="No Anys on this line!" content="        allows us to retain error information until the counterpart has been" number="216" precision="empty"/><line any_info="No Anys on this line!" content="        restarted." number="217" precision="empty"/><line any_info="No Anys on this line!" content="" number="218" precision="empty"/><line any_info="No Anys on this line!" content="        :param status_message: the status message received from the other ChannelRW entity" number="219" precision="empty"/><line any_info="No Anys on this line!" content="        &quot;&quot;&quot;" number="220" precision="empty"/><line any_info="No Anys on this line!" content="" number="221" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        if status_message.get_channel_unique_name() != self.get_channel_unique_name():" number="222" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            raise AttributeError(f&quot;Invalid status message, &quot;" number="223" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="                                 f&quot;mismatching channel name: {status_message.get_channel_unique_name()}&quot;)" number="224" precision="precise"/><line any_info="No Anys on this line!" content="" number="225" precision="empty"/><line any_info="No Anys on this line!" content="        # int has been merged with long https://www.python.org/dev/peps/pep-0237/" number="226" precision="empty"/><line any_info="No Anys on this line!" content="        status_update_time = int(float(status_message.timestamp))" number="227" precision="precise"/><line any_info="No Anys on this line!" content="" number="228" precision="empty"/><line any_info="No Anys on this line!" content="        if status_update_time &gt; self.last_update_sent_timestamp_ms:" number="229" precision="precise"/><line any_info="No Anys on this line!" content="            self.last_update_sent_timestamp_ms = status_update_time" number="230" precision="precise"/><line any_info="No Anys on this line!" content="        elif status_update_time &lt; self.last_update_sent_timestamp_ms:" number="231" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self.logger.warn(f&quot;WARNING - the current status message has lower timestamp &quot;" number="232" precision="any"/><line any_info="No Anys on this line!" content="                             f&quot;({status_message.timestamp}) than the last received &quot;" number="233" precision="precise"/><line any_info="No Anys on this line!" content="                             f&quot;({self.last_update_sent_timestamp_ms}). This may be caused by network latency, &quot;" number="234" precision="precise"/><line any_info="No Anys on this line!" content="                             f&quot;but if you repeatedly see this warning, then you should investigate the causes. &quot;" number="235" precision="empty"/><line any_info="No Anys on this line!" content="                             f&quot;({status_message})&quot;)" number="236" precision="empty"/><line any_info="No Anys on this line!" content="" number="237" precision="empty"/><line any_info="No Anys on this line!" content="        new_status = self.current_status" number="238" precision="precise"/><line any_info="No Anys on this line!" content="" number="239" precision="empty"/><line any_info="No Anys on this line!" content="        if (ChannelStatus.Opened == status_message.status) or \" number="240" precision="precise"/><line any_info="No Anys on this line!" content="           (ChannelStatus.Closed == status_message.status) or \" number="241" precision="precise"/><line any_info="No Anys on this line!" content="           (ChannelStatus.Started == status_message.status) or \" number="242" precision="precise"/><line any_info="No Anys on this line!" content="           (ChannelStatus.Stopped == status_message.status) or \" number="243" precision="precise"/><line any_info="No Anys on this line!" content="           (ChannelStatus.Error == status_message.status):" number="244" precision="precise"/><line any_info="No Anys on this line!" content="            if status_update_time &gt;= self.last_status_change_timestamp_ms:" number="245" precision="precise"/><line any_info="No Anys on this line!" content="                if ChannelStatus.Error != self.current_status:" number="246" precision="precise"/><line any_info="No Anys on this line!" content="                    new_status = status_message.status" number="247" precision="precise"/><line any_info="No Anys on this line!" content="                elif (ChannelStatus.Opened == status_message.status) or \" number="248" precision="precise"/><line any_info="No Anys on this line!" content="                     (ChannelStatus.Started == status_message.status):" number="249" precision="precise"/><line any_info="No Anys on this line!" content="                    new_status = status_message.status" number="250" precision="precise"/><line any_info="No Anys on this line!" content="" number="251" precision="empty"/><line any_info="No Anys on this line!" content="        if (new_status is None) or (new_status != self.current_status):" number="252" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            self.logger.debug(f&quot;{self.current_status} -&gt; {new_status} @ {status_update_time}&quot;)" number="253" precision="any"/><line any_info="No Anys on this line!" content="            self.current_status = new_status" number="254" precision="precise"/><line any_info="No Anys on this line!" content="            self.last_status_change_timestamp_ms = status_update_time" number="255" precision="precise"/><line any_info="No Anys on this line!" content="" number="256" precision="empty"/><line any_info="Any Types on this line: &#10;Explicit (x1)" content="        if status_message.payload is not None:" number="257" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)&#10;Explicit (x1)" content="            self.logger.debug(f&quot;Message payload: {status_message.payload}&quot;)" number="258" precision="any"/><line any_info="No Anys on this line!" content="" number="259" precision="empty"/><line any_info="No Anys on this line!" content="        if self.status_update_callback is not None:" number="260" precision="precise"/><line any_info="No Anys on this line!" content="            self.status_update_callback(status_message)" number="261" precision="precise"/><line any_info="No Anys on this line!" content="" number="262" precision="empty"/><line any_info="No Anys on this line!" content="        self.status_update_map[status_message.status] = status_update_time" number="263" precision="precise"/></mypy-report-file>