<?xml-stylesheet type="text/xsl" href="../../../../mypy-html.xslt"?><mypy-report-file name="plugins\kafka_io\test\resources.py" module="plugins.kafka_io.test.resources"><line any_info="No Anys on this line!" content="# =============================================================================" number="1" precision="empty"/><line any_info="No Anys on this line!" content="# Copyright (c) 2024 by Laszlo Anka. All rights reserved." number="2" precision="empty"/><line any_info="No Anys on this line!" content="#" number="3" precision="empty"/><line any_info="No Anys on this line!" content="# Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);" number="4" precision="empty"/><line any_info="No Anys on this line!" content="# you may not use this file except in compliance with the License." number="5" precision="empty"/><line any_info="No Anys on this line!" content="# You may obtain a copy of the License at" number="6" precision="empty"/><line any_info="No Anys on this line!" content="#" number="7" precision="empty"/><line any_info="No Anys on this line!" content="#     http://www.apache.org/licenses/LICENSE-2.0" number="8" precision="empty"/><line any_info="No Anys on this line!" content="#" number="9" precision="empty"/><line any_info="No Anys on this line!" content="# Unless required by applicable law or agreed to in writing, software" number="10" precision="empty"/><line any_info="No Anys on this line!" content="# distributed under the License is distributed on an &quot;AS IS&quot; BASIS," number="11" precision="empty"/><line any_info="No Anys on this line!" content="# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied." number="12" precision="empty"/><line any_info="No Anys on this line!" content="# See the License for the specific language governing permissions and" number="13" precision="empty"/><line any_info="No Anys on this line!" content="# limitations under the License." number="14" precision="empty"/><line any_info="No Anys on this line!" content="# =============================================================================" number="15" precision="empty"/><line any_info="No Anys on this line!" content="from typing import Optional" number="16" precision="precise"/><line any_info="No Anys on this line!" content="" number="17" precision="empty"/><line any_info="No Anys on this line!" content="from pypz.plugins.loggers.default import DefaultLoggerPlugin" number="18" precision="any"/><line any_info="No Anys on this line!" content="from pypz.plugins.kafka_io.ports import KafkaChannelOutputPort, KafkaChannelInputPort" number="19" precision="any"/><line any_info="No Anys on this line!" content="from pypz.core.commons.parameters import OptionalParameter" number="20" precision="any"/><line any_info="No Anys on this line!" content="from pypz.core.specs.misc import BlankOperator" number="21" precision="any"/><line any_info="No Anys on this line!" content="from pypz.core.specs.pipeline import Pipeline" number="22" precision="any"/><line any_info="No Anys on this line!" content="from pypz.core.specs.instance import Instance, InstanceGroup" number="23" precision="any"/><line any_info="No Anys on this line!" content="" number="24" precision="empty"/><line any_info="No Anys on this line!" content="avro_schema_string = &quot;&quot;&quot;" number="25" precision="precise"/><line any_info="No Anys on this line!" content="{" number="26" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;type&quot;: &quot;record&quot;," number="27" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;name&quot;: &quot;DemoRecord&quot;," number="28" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;fields&quot;: [" number="29" precision="empty"/><line any_info="No Anys on this line!" content="        {" number="30" precision="empty"/><line any_info="No Anys on this line!" content="            &quot;name&quot;: &quot;demoText&quot;," number="31" precision="empty"/><line any_info="No Anys on this line!" content="            &quot;type&quot;: &quot;string&quot;" number="32" precision="empty"/><line any_info="No Anys on this line!" content="        }" number="33" precision="empty"/><line any_info="No Anys on this line!" content="    ]" number="34" precision="empty"/><line any_info="No Anys on this line!" content="}" number="35" precision="empty"/><line any_info="No Anys on this line!" content="&quot;&quot;&quot;" number="36" precision="empty"/><line any_info="No Anys on this line!" content="" number="37" precision="empty"/><line any_info="No Anys on this line!" content="" number="38" precision="empty"/><line any_info="No Anys on this line!" content="class TestWriterOperator(BlankOperator):" number="39" precision="precise"/><line any_info="No Anys on this line!" content="" number="40" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="    max_record_count = OptionalParameter(int, alt_name=&quot;maxRecordCount&quot;)" number="41" precision="any"/><line any_info="No Anys on this line!" content="" number="42" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="    def __init__(self, name: str = None, *args, **kwargs):" number="43" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="        super().__init__(name, *args, **kwargs)" number="44" precision="imprecise"/><line any_info="No Anys on this line!" content="" number="45" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="        self.output_port = KafkaChannelOutputPort(schema=avro_schema_string)" number="46" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="        self.group_output_port = KafkaChannelOutputPort(schema=avro_schema_string)" number="47" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="        self.logger = DefaultLoggerPlugin()" number="48" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="        self.logger.set_parameter(&quot;logLevel&quot;, &quot;DEBUG&quot;)" number="49" precision="any"/><line any_info="No Anys on this line!" content="" number="50" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="        self.max_record_count = 2" number="51" precision="any"/><line any_info="No Anys on this line!" content="        self.record_count = 0" number="52" precision="precise"/><line any_info="No Anys on this line!" content="" number="53" precision="empty"/><line any_info="No Anys on this line!" content="    def _on_init(self) -&gt; bool:" number="54" precision="precise"/><line any_info="No Anys on this line!" content="        return True" number="55" precision="precise"/><line any_info="No Anys on this line!" content="" number="56" precision="empty"/><line any_info="No Anys on this line!" content="    def _on_shutdown(self) -&gt; bool:" number="57" precision="precise"/><line any_info="No Anys on this line!" content="        return True" number="58" precision="precise"/><line any_info="No Anys on this line!" content="" number="59" precision="empty"/><line any_info="No Anys on this line!" content="    def _on_running(self) -&gt; bool:" number="60" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="        self.output_port.send([{&quot;demoText&quot;: f&quot;record_{self.record_count}&quot;}])" number="61" precision="any"/><line any_info="No Anys on this line!" content="" number="62" precision="empty"/><line any_info="No Anys on this line!" content="        self.record_count += 1" number="63" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="        if self.record_count == self.max_record_count:" number="64" precision="any"/><line any_info="No Anys on this line!" content="            return True" number="65" precision="precise"/><line any_info="No Anys on this line!" content="        return False" number="66" precision="precise"/><line any_info="No Anys on this line!" content="" number="67" precision="empty"/><line any_info="No Anys on this line!" content="" number="68" precision="empty"/><line any_info="No Anys on this line!" content="class TestReaderOperator(BlankOperator):" number="69" precision="precise"/><line any_info="No Anys on this line!" content="" number="70" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="    def __init__(self, name: str = None, *args, **kwargs):" number="71" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="        super().__init__(name, *args, **kwargs)" number="72" precision="imprecise"/><line any_info="No Anys on this line!" content="" number="73" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="        self.input_port = KafkaChannelInputPort(schema=avro_schema_string)" number="74" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="        self.group_input_port = KafkaChannelInputPort(schema=avro_schema_string, group_mode=True)" number="75" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="        self.logger = DefaultLoggerPlugin()" number="76" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="        self.logger.set_parameter(&quot;logLevel&quot;, &quot;DEBUG&quot;)" number="77" precision="any"/><line any_info="Any Types on this line: &#10;Omitted Generics (x6)" content="        self.received_records: list = list()" number="78" precision="imprecise"/><line any_info="No Anys on this line!" content="" number="79" precision="empty"/><line any_info="No Anys on this line!" content="    def _on_init(self) -&gt; bool:" number="80" precision="precise"/><line any_info="No Anys on this line!" content="        return True" number="81" precision="precise"/><line any_info="No Anys on this line!" content="" number="82" precision="empty"/><line any_info="No Anys on this line!" content="    def _on_shutdown(self) -&gt; bool:" number="83" precision="precise"/><line any_info="No Anys on this line!" content="        return True" number="84" precision="precise"/><line any_info="No Anys on this line!" content="" number="85" precision="empty"/><line any_info="No Anys on this line!" content="    def _on_running(self) -&gt; bool:" number="86" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x4)" content="        records = self.input_port.retrieve()" number="87" precision="any"/><line any_info="Any Types on this line: &#10;Omitted Generics (x2)&#10;Unimported (x1)" content="        self.received_records.extend(records)" number="88" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="        for record in records:" number="89" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="            self.get_logger().debug(record)" number="90" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="        return not self.input_port.can_retrieve()" number="91" precision="any"/><line any_info="No Anys on this line!" content="" number="92" precision="empty"/><line any_info="No Anys on this line!" content="" number="93" precision="empty"/><line any_info="No Anys on this line!" content="class TestPipeline(Pipeline):" number="94" precision="precise"/><line any_info="No Anys on this line!" content="" number="95" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="    def __init__(self, name: str = None, *args, **kwargs):" number="96" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="        super().__init__(name, *args, **kwargs)" number="97" precision="imprecise"/><line any_info="No Anys on this line!" content="" number="98" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="        self.reader = TestReaderOperator()" number="99" precision="precise"/><line any_info="No Anys on this line!" content="        self.reader.set_parameter(&quot;replicationFactor&quot;, 1)" number="100" precision="precise"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="        self.writer = TestWriterOperator()" number="101" precision="precise"/><line any_info="No Anys on this line!" content="        self.writer.set_parameter(&quot;replicationFactor&quot;, 1)" number="102" precision="precise"/><line any_info="No Anys on this line!" content="" number="103" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x4)" content="        self.reader.input_port.connect(self.writer.output_port)" number="104" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x4)" content="        self.reader.group_input_port.connect(self.writer.group_output_port)" number="105" precision="any"/><line any_info="No Anys on this line!" content="" number="106" precision="empty"/><line any_info="No Anys on this line!" content="" number="107" precision="empty"/><line any_info="No Anys on this line!" content="class TestGroupInfo(InstanceGroup):" number="108" precision="precise"/><line any_info="No Anys on this line!" content="" number="109" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def __init__(self, group_size: int = 1," number="110" precision="imprecise"/><line any_info="No Anys on this line!" content="                 group_index: int = 0," number="111" precision="precise"/><line any_info="No Anys on this line!" content="                 group_name: str = None," number="112" precision="precise"/><line any_info="No Anys on this line!" content="                 group_principal: Instance = None," number="113" precision="precise"/><line any_info="No Anys on this line!" content="                 is_principal: bool = None):" number="114" precision="precise"/><line any_info="No Anys on this line!" content="        self._group_size = group_size" number="115" precision="precise"/><line any_info="No Anys on this line!" content="        self._group_index = group_index" number="116" precision="precise"/><line any_info="No Anys on this line!" content="        self._group_name = group_name" number="117" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="        self._group_principal = group_principal" number="118" precision="imprecise"/><line any_info="No Anys on this line!" content="        self._is_principal = is_principal if is_principal is not None else (group_index == 0)" number="119" precision="precise"/><line any_info="No Anys on this line!" content="" number="120" precision="empty"/><line any_info="No Anys on this line!" content="    def get_group_size(self) -&gt; int:" number="121" precision="precise"/><line any_info="No Anys on this line!" content="        return self._group_size" number="122" precision="precise"/><line any_info="No Anys on this line!" content="" number="123" precision="empty"/><line any_info="No Anys on this line!" content="    def get_group_index(self) -&gt; int:" number="124" precision="precise"/><line any_info="No Anys on this line!" content="        return self._group_index" number="125" precision="precise"/><line any_info="No Anys on this line!" content="" number="126" precision="empty"/><line any_info="No Anys on this line!" content="    def get_group_name(self) -&gt; Optional[str]:" number="127" precision="precise"/><line any_info="No Anys on this line!" content="        return self._group_name" number="128" precision="precise"/><line any_info="No Anys on this line!" content="" number="129" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="    def get_group_principal(self) -&gt; Optional[Instance]:" number="130" precision="imprecise"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="        return self._group_principal" number="131" precision="imprecise"/><line any_info="No Anys on this line!" content="" number="132" precision="empty"/><line any_info="No Anys on this line!" content="    def is_principal(self) -&gt; bool:" number="133" precision="precise"/><line any_info="No Anys on this line!" content="        return self._is_principal" number="134" precision="precise"/></mypy-report-file>