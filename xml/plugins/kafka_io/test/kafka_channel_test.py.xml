<?xml-stylesheet type="text/xsl" href="../../../../mypy-html.xslt"?><mypy-report-file name="plugins\kafka_io\test\kafka_channel_test.py" module="plugins.kafka_io.test.kafka_channel_test"><line any_info="No Anys on this line!" content="# =============================================================================" number="1" precision="empty"/><line any_info="No Anys on this line!" content="# Copyright (c) 2024 by Laszlo Anka. All rights reserved." number="2" precision="empty"/><line any_info="No Anys on this line!" content="#" number="3" precision="empty"/><line any_info="No Anys on this line!" content="# Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);" number="4" precision="empty"/><line any_info="No Anys on this line!" content="# you may not use this file except in compliance with the License." number="5" precision="empty"/><line any_info="No Anys on this line!" content="# You may obtain a copy of the License at" number="6" precision="empty"/><line any_info="No Anys on this line!" content="#" number="7" precision="empty"/><line any_info="No Anys on this line!" content="#     http://www.apache.org/licenses/LICENSE-2.0" number="8" precision="empty"/><line any_info="No Anys on this line!" content="#" number="9" precision="empty"/><line any_info="No Anys on this line!" content="# Unless required by applicable law or agreed to in writing, software" number="10" precision="empty"/><line any_info="No Anys on this line!" content="# distributed under the License is distributed on an &quot;AS IS&quot; BASIS," number="11" precision="empty"/><line any_info="No Anys on this line!" content="# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied." number="12" precision="empty"/><line any_info="No Anys on this line!" content="# See the License for the specific language governing permissions and" number="13" precision="empty"/><line any_info="No Anys on this line!" content="# limitations under the License." number="14" precision="empty"/><line any_info="No Anys on this line!" content="# =============================================================================" number="15" precision="empty"/><line any_info="No Anys on this line!" content="import time" number="16" precision="precise"/><line any_info="No Anys on this line!" content="import unittest" number="17" precision="precise"/><line any_info="No Anys on this line!" content="" number="18" precision="empty"/><line any_info="No Anys on this line!" content="from avro.schema import SchemaParseException" number="19" precision="any"/><line any_info="No Anys on this line!" content="from kafka import KafkaAdminClient, TopicPartition, KafkaConsumer" number="20" precision="any"/><line any_info="No Anys on this line!" content="from kafka.errors import UnknownTopicOrPartitionError" number="21" precision="any"/><line any_info="No Anys on this line!" content="" number="22" precision="empty"/><line any_info="No Anys on this line!" content="from plugins.kafka_io.test.resources import TestReaderOperator" number="23" precision="precise"/><line any_info="No Anys on this line!" content="from pypz.core.specs.misc import BlankInputPortPlugin, BlankOutputPortPlugin" number="24" precision="any"/><line any_info="No Anys on this line!" content="from pypz.plugins.kafka_io.channels import ReaderStatusTopicNameExtension, WriterStatusTopicNameExtension, \" number="25" precision="any"/><line any_info="No Anys on this line!" content="    KafkaChannelReader, KafkaChannelWriter" number="26" precision="empty"/><line any_info="No Anys on this line!" content="" number="27" precision="empty"/><line any_info="No Anys on this line!" content="" number="28" precision="empty"/><line any_info="No Anys on this line!" content="class KafkaChannelTest(unittest.TestCase):" number="29" precision="precise"/><line any_info="No Anys on this line!" content="" number="30" precision="empty"/><line any_info="No Anys on this line!" content="    bootstrap_url = &quot;localhost:9092&quot;" number="31" precision="precise"/><line any_info="No Anys on this line!" content="" number="32" precision="empty"/><line any_info="No Anys on this line!" content="    test_channel_name = &quot;test_channel&quot;" number="33" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="    test_reader_status_name = test_channel_name + ReaderStatusTopicNameExtension" number="34" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="    test_writer_status_name = test_channel_name + WriterStatusTopicNameExtension" number="35" precision="any"/><line any_info="No Anys on this line!" content="" number="36" precision="empty"/><line any_info="No Anys on this line!" content="    avro_schema_string = &quot;&quot;&quot;" number="37" precision="precise"/><line any_info="No Anys on this line!" content="    {" number="38" precision="empty"/><line any_info="No Anys on this line!" content="        &quot;type&quot;: &quot;record&quot;," number="39" precision="empty"/><line any_info="No Anys on this line!" content="        &quot;name&quot;: &quot;DemoRecord&quot;," number="40" precision="empty"/><line any_info="No Anys on this line!" content="        &quot;fields&quot;: [" number="41" precision="empty"/><line any_info="No Anys on this line!" content="            {" number="42" precision="empty"/><line any_info="No Anys on this line!" content="                &quot;name&quot;: &quot;demoText&quot;," number="43" precision="empty"/><line any_info="No Anys on this line!" content="                &quot;type&quot;: &quot;string&quot;" number="44" precision="empty"/><line any_info="No Anys on this line!" content="            }" number="45" precision="empty"/><line any_info="No Anys on this line!" content="        ]" number="46" precision="empty"/><line any_info="No Anys on this line!" content="    }" number="47" precision="empty"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;" number="48" precision="empty"/><line any_info="No Anys on this line!" content="" number="49" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x2)" content="    test_admin_client: KafkaAdminClient" number="50" precision="any"/><line any_info="No Anys on this line!" content="" number="51" precision="empty"/><line any_info="No Anys on this line!" content="    @staticmethod" number="52" precision="empty"/><line any_info="Any Types on this line: &#10;Omitted Generics (x2)" content="    def generate_records(record_count: int) -&gt; list[dict]:" number="53" precision="imprecise"/><line any_info="Any Types on this line: &#10;Omitted Generics (x3)" content="        generated_records = list()" number="54" precision="precise"/><line any_info="No Anys on this line!" content="" number="55" precision="empty"/><line any_info="No Anys on this line!" content="        for idx in range(record_count):" number="56" precision="precise"/><line any_info="No Anys on this line!" content="            generated_records.append({" number="57" precision="precise"/><line any_info="No Anys on this line!" content="                &quot;demoText&quot;: f&quot;record_{idx}&quot;" number="58" precision="precise"/><line any_info="No Anys on this line!" content="            })" number="59" precision="empty"/><line any_info="No Anys on this line!" content="" number="60" precision="empty"/><line any_info="No Anys on this line!" content="        return generated_records" number="61" precision="precise"/><line any_info="No Anys on this line!" content="" number="62" precision="empty"/><line any_info="No Anys on this line!" content="    @classmethod" number="63" precision="empty"/><line any_info="No Anys on this line!" content="    def setUpClass(cls) -&gt; None:" number="64" precision="precise"/><line any_info="No Anys on this line!" content="        time.sleep(2)" number="65" precision="precise"/><line any_info="No Anys on this line!" content="" number="66" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x4)" content="        cls.test_admin_client: KafkaAdminClient = KafkaAdminClient(bootstrap_servers=KafkaChannelTest.bootstrap_url)" number="67" precision="any"/><line any_info="No Anys on this line!" content="" number="68" precision="empty"/><line any_info="No Anys on this line!" content="    @classmethod" number="69" precision="empty"/><line any_info="No Anys on this line!" content="    def tearDownClass(cls) -&gt; None:" number="70" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="        cls.test_admin_client.close()" number="71" precision="any"/><line any_info="No Anys on this line!" content="" number="72" precision="empty"/><line any_info="No Anys on this line!" content="    def tearDown(self) -&gt; None:" number="73" precision="precise"/><line any_info="No Anys on this line!" content="        try:" number="74" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x3)" content="            KafkaChannelTest.test_admin_client.delete_topics([" number="75" precision="any"/><line any_info="No Anys on this line!" content="                KafkaChannelTest.test_channel_name," number="76" precision="precise"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="                KafkaChannelTest.test_writer_status_name," number="77" precision="any"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="                KafkaChannelTest.test_reader_status_name" number="78" precision="any"/><line any_info="No Anys on this line!" content="            ])" number="79" precision="empty"/><line any_info="Any Types on this line: &#10;Unimported (x1)" content="        except UnknownTopicOrPartitionError:" number="80" precision="any"/><line any_info="No Anys on this line!" content="            pass" number="81" precision="precise"/><line any_info="No Anys on this line!" content="" number="82" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_with_invalid_schema_expect_error(self):" number="83" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="84" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)&#10;Unimported (x1)" content="                                    context=BlankInputPortPlugin(&quot;reader&quot;, schema=&quot;&quot;))" number="85" precision="any"/><line any_info="No Anys on this line!" content="" number="86" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="        with self.assertRaises(SchemaParseException):" number="87" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_read_records()" number="88" precision="any"/><line any_info="No Anys on this line!" content="" number="89" precision="empty"/><line any_info="No Anys on this line!" content="    def test_writer_with_invalid_schema_expect_error(self):" number="90" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        writer = KafkaChannelWriter(channel_name=KafkaChannelTest.test_channel_name," number="91" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)&#10;Unimported (x1)" content="                                    context=BlankOutputPortPlugin(&quot;writer&quot;, schema=&quot;&quot;))" number="92" precision="any"/><line any_info="No Anys on this line!" content="" number="93" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="        with self.assertRaises(SchemaParseException):" number="94" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_write_records([{}])" number="95" precision="any"/><line any_info="No Anys on this line!" content="" number="96" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_invoke_resource_creation_without_provided_location_expect_error(self):" number="97" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="98" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankInputPortPlugin(&quot;reader&quot;, schema=KafkaChannelTest.avro_schema_string))" number="99" precision="any"/><line any_info="No Anys on this line!" content="" number="100" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="        with self.assertRaises(AttributeError):" number="101" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_resource_creation()" number="102" precision="any"/><line any_info="No Anys on this line!" content="" number="103" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_invoke_resource_creation_expect_resource_created(self):" number="104" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="105" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankInputPortPlugin(&quot;reader&quot;, schema=KafkaChannelTest.avro_schema_string))" number="106" precision="any"/><line any_info="No Anys on this line!" content="" number="107" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="108" precision="any"/><line any_info="No Anys on this line!" content="" number="109" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="110" precision="any"/><line any_info="No Anys on this line!" content="" number="111" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        existing_topics = KafkaChannelTest.test_admin_client.list_topics()" number="112" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertNotIn(KafkaChannelTest.test_channel_name, existing_topics)" number="113" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertNotIn(KafkaChannelTest.test_writer_status_name, existing_topics)" number="114" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertNotIn(KafkaChannelTest.test_reader_status_name, existing_topics)" number="115" precision="any"/><line any_info="No Anys on this line!" content="" number="116" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_creation())" number="117" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.is_resource_created())" number="118" precision="any"/><line any_info="No Anys on this line!" content="" number="119" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="120" precision="any"/><line any_info="No Anys on this line!" content="" number="121" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        existing_topics = KafkaChannelTest.test_admin_client.list_topics()" number="122" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_channel_name, existing_topics)" number="123" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_writer_status_name, existing_topics)" number="124" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_reader_status_name, existing_topics)" number="125" precision="any"/><line any_info="No Anys on this line!" content="" number="126" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        KafkaChannelTest.test_admin_client.delete_topics([" number="127" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            KafkaChannelTest.test_channel_name," number="128" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            KafkaChannelTest.test_writer_status_name," number="129" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            KafkaChannelTest.test_reader_status_name" number="130" precision="any"/><line any_info="No Anys on this line!" content="        ])" number="131" precision="empty"/><line any_info="No Anys on this line!" content="" number="132" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_invoke_resource_creation_with_group_expect_proper_partition_count(self):" number="133" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        operator = TestReaderOperator(&quot;reader&quot;)" number="134" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        operator.set_parameter(&quot;replicationFactor&quot;, 12)" number="135" precision="any"/><line any_info="No Anys on this line!" content="" number="136" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="137" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="                                    context=operator.input_port)" number="138" precision="any"/><line any_info="No Anys on this line!" content="" number="139" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="140" precision="any"/><line any_info="No Anys on this line!" content="" number="141" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_creation())" number="142" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.is_resource_created())" number="143" precision="any"/><line any_info="No Anys on this line!" content="" number="144" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="145" precision="any"/><line any_info="No Anys on this line!" content="" number="146" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        existing_topics = KafkaChannelTest.test_admin_client.list_topics()" number="147" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_channel_name, existing_topics)" number="148" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_writer_status_name, existing_topics)" number="149" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_reader_status_name, existing_topics)" number="150" precision="any"/><line any_info="No Anys on this line!" content="" number="151" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        topics = KafkaChannelTest.test_admin_client.describe_topics([KafkaChannelTest.test_channel_name])" number="152" precision="any"/><line any_info="No Anys on this line!" content="" number="153" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertEqual(1, len(topics))" number="154" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="        self.assertEqual(13, len(topics[0][&quot;partitions&quot;]))" number="155" precision="any"/><line any_info="No Anys on this line!" content="" number="156" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        KafkaChannelTest.test_admin_client.delete_topics([" number="157" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            KafkaChannelTest.test_channel_name," number="158" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            KafkaChannelTest.test_writer_status_name," number="159" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            KafkaChannelTest.test_reader_status_name" number="160" precision="any"/><line any_info="No Anys on this line!" content="        ])" number="161" precision="empty"/><line any_info="No Anys on this line!" content="" number="162" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_invoke_resource_creation_with_group_mode_expect_proper_partition_count(self):" number="163" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        operator = TestReaderOperator(&quot;reader&quot;)" number="164" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        operator.set_parameter(&quot;replicationFactor&quot;, 12)" number="165" precision="any"/><line any_info="No Anys on this line!" content="" number="166" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="167" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="                                    context=operator.group_input_port)" number="168" precision="any"/><line any_info="No Anys on this line!" content="" number="169" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="170" precision="any"/><line any_info="No Anys on this line!" content="" number="171" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_creation())" number="172" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.is_resource_created())" number="173" precision="any"/><line any_info="No Anys on this line!" content="" number="174" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="175" precision="any"/><line any_info="No Anys on this line!" content="" number="176" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        existing_topics = KafkaChannelTest.test_admin_client.list_topics()" number="177" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_channel_name, existing_topics)" number="178" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_writer_status_name, existing_topics)" number="179" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_reader_status_name, existing_topics)" number="180" precision="any"/><line any_info="No Anys on this line!" content="" number="181" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        topics = KafkaChannelTest.test_admin_client.describe_topics([KafkaChannelTest.test_channel_name])" number="182" precision="any"/><line any_info="No Anys on this line!" content="" number="183" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertEqual(1, len(topics))" number="184" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="        self.assertEqual(1, len(topics[0][&quot;partitions&quot;]))" number="185" precision="any"/><line any_info="No Anys on this line!" content="" number="186" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        KafkaChannelTest.test_admin_client.delete_topics([" number="187" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            KafkaChannelTest.test_channel_name," number="188" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            KafkaChannelTest.test_writer_status_name," number="189" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            KafkaChannelTest.test_reader_status_name" number="190" precision="any"/><line any_info="No Anys on this line!" content="        ])" number="191" precision="empty"/><line any_info="No Anys on this line!" content="" number="192" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_invoke_resource_creation_with_group_with_existing_topic_expect_topic_update(self):" number="193" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        operator = TestReaderOperator(&quot;reader&quot;)" number="194" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        operator.set_parameter(&quot;replicationFactor&quot;, 1)" number="195" precision="any"/><line any_info="No Anys on this line!" content="" number="196" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="197" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                                    context=operator.get_replica(0).input_port)" number="198" precision="any"/><line any_info="No Anys on this line!" content="" number="199" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="200" precision="any"/><line any_info="No Anys on this line!" content="" number="201" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_creation())" number="202" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.is_resource_created())" number="203" precision="any"/><line any_info="No Anys on this line!" content="" number="204" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="205" precision="any"/><line any_info="No Anys on this line!" content="" number="206" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        existing_topics = KafkaChannelTest.test_admin_client.list_topics()" number="207" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_channel_name, existing_topics)" number="208" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_writer_status_name, existing_topics)" number="209" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_reader_status_name, existing_topics)" number="210" precision="any"/><line any_info="No Anys on this line!" content="" number="211" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        topics = KafkaChannelTest.test_admin_client.describe_topics([KafkaChannelTest.test_channel_name])" number="212" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="        self.assertEqual(2, len(topics[0][&quot;partitions&quot;]))" number="213" precision="any"/><line any_info="No Anys on this line!" content="" number="214" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        operator = TestReaderOperator(&quot;reader&quot;)" number="215" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        operator.set_parameter(&quot;replicationFactor&quot;, 4)" number="216" precision="any"/><line any_info="No Anys on this line!" content="" number="217" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="218" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                                    context=operator.get_replica(0).input_port)" number="219" precision="any"/><line any_info="No Anys on this line!" content="" number="220" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="221" precision="any"/><line any_info="No Anys on this line!" content="" number="222" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_creation())" number="223" precision="any"/><line any_info="No Anys on this line!" content="" number="224" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="225" precision="any"/><line any_info="No Anys on this line!" content="" number="226" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.is_resource_created())" number="227" precision="any"/><line any_info="No Anys on this line!" content="" number="228" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        topics = KafkaChannelTest.test_admin_client.describe_topics([KafkaChannelTest.test_channel_name])" number="229" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="        self.assertEqual(5, len(topics[0][&quot;partitions&quot;]))" number="230" precision="any"/><line any_info="No Anys on this line!" content="" number="231" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        KafkaChannelTest.test_admin_client.delete_topics([" number="232" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            KafkaChannelTest.test_channel_name," number="233" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            KafkaChannelTest.test_writer_status_name," number="234" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            KafkaChannelTest.test_reader_status_name" number="235" precision="any"/><line any_info="No Anys on this line!" content="        ])" number="236" precision="empty"/><line any_info="No Anys on this line!" content="" number="237" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_invoke_resource_deletion_expect_resource_deleted(self):" number="238" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="239" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankInputPortPlugin(&quot;reader&quot;, schema=KafkaChannelTest.avro_schema_string))" number="240" precision="any"/><line any_info="No Anys on this line!" content="" number="241" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="242" precision="any"/><line any_info="No Anys on this line!" content="" number="243" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_creation())" number="244" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.is_resource_created())" number="245" precision="any"/><line any_info="No Anys on this line!" content="" number="246" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="247" precision="any"/><line any_info="No Anys on this line!" content="" number="248" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        existing_topics = KafkaChannelTest.test_admin_client.list_topics()" number="249" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_channel_name, existing_topics)" number="250" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_writer_status_name, existing_topics)" number="251" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertIn(KafkaChannelTest.test_reader_status_name, existing_topics)" number="252" precision="any"/><line any_info="No Anys on this line!" content="" number="253" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_deletion())" number="254" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.is_resource_deleted())" number="255" precision="any"/><line any_info="No Anys on this line!" content="" number="256" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="257" precision="any"/><line any_info="No Anys on this line!" content="" number="258" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        existing_topics = KafkaChannelTest.test_admin_client.list_topics()" number="259" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertNotIn(KafkaChannelTest.test_channel_name, existing_topics)" number="260" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertNotIn(KafkaChannelTest.test_writer_status_name, existing_topics)" number="261" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertNotIn(KafkaChannelTest.test_reader_status_name, existing_topics)" number="262" precision="any"/><line any_info="No Anys on this line!" content="" number="263" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_invoke_open_channel_expect_consumers_and_subscription_init(self):" number="264" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="265" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankInputPortPlugin(&quot;reader&quot;, schema=KafkaChannelTest.avro_schema_string))" number="266" precision="any"/><line any_info="No Anys on this line!" content="" number="267" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="268" precision="any"/><line any_info="No Anys on this line!" content="" number="269" precision="empty"/><line any_info="No Anys on this line!" content="        try:" number="270" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_creation())" number="271" precision="any"/><line any_info="No Anys on this line!" content="" number="272" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(1)" number="273" precision="any"/><line any_info="No Anys on this line!" content="" number="274" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.is_resource_created())" number="275" precision="any"/><line any_info="No Anys on this line!" content="" number="276" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_open_channel())" number="277" precision="any"/><line any_info="No Anys on this line!" content="" number="278" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            self.assertIsNotNone(reader._data_consumer)" number="279" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            self.assertIsNotNone(reader._writer_status_consumer)" number="280" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            self.assertIsNotNone(reader._reader_status_producer)" number="281" precision="any"/><line any_info="No Anys on this line!" content="" number="282" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)&#10;Unimported (x1)" content="            self.assertEqual({TopicPartition(KafkaChannelTest.test_channel_name, 0)}," number="283" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                             reader._data_consumer.assignment())" number="284" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x9)" content="            self.assertEqual(reader.get_unique_name() + &quot;.&quot; + reader._data_topic_name," number="285" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                             reader._data_consumer.config[&quot;group_id&quot;])" number="286" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x9)" content="            self.assertEqual(reader.get_unique_name(), reader._data_consumer.config[&quot;client_id&quot;])" number="287" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)&#10;Unimported (x2)" content="            self.assertEqual({TopicPartition(KafkaChannelTest.test_channel_name + WriterStatusTopicNameExtension, 0)}," number="288" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                             reader._writer_status_consumer.assignment())" number="289" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x9)" content="            self.assertEqual(reader.get_unique_name() + &quot;.&quot; + reader._writer_status_topic_name," number="290" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                             reader._writer_status_consumer.config[&quot;group_id&quot;])" number="291" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x9)" content="            self.assertEqual(reader.get_unique_name(), reader._writer_status_consumer.config[&quot;client_id&quot;])" number="292" precision="any"/><line any_info="No Anys on this line!" content="" number="293" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_close_channel())" number="294" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_deletion())" number="295" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        except Exception as e:" number="296" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_close_channel()" number="297" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_resource_deletion()" number="298" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            self.fail(e)" number="299" precision="any"/><line any_info="No Anys on this line!" content="" number="300" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_invoke_open_channel_in_group_for_principal_expect_consumers_and_subscription_init(self):" number="301" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        operator = TestReaderOperator(&quot;reader&quot;)" number="302" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        operator.set_parameter(&quot;replicationFactor&quot;, 1)" number="303" precision="any"/><line any_info="No Anys on this line!" content="" number="304" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="305" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="                                    context=operator.input_port)" number="306" precision="any"/><line any_info="No Anys on this line!" content="" number="307" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="308" precision="any"/><line any_info="No Anys on this line!" content="" number="309" precision="empty"/><line any_info="No Anys on this line!" content="        try:" number="310" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_creation())" number="311" precision="any"/><line any_info="No Anys on this line!" content="" number="312" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(1)" number="313" precision="any"/><line any_info="No Anys on this line!" content="" number="314" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.is_resource_created())" number="315" precision="any"/><line any_info="No Anys on this line!" content="" number="316" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_open_channel())" number="317" precision="any"/><line any_info="No Anys on this line!" content="" number="318" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            self.assertIsNotNone(reader._data_consumer)" number="319" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            self.assertIsNotNone(reader._writer_status_consumer)" number="320" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            self.assertIsNotNone(reader._reader_status_producer)" number="321" precision="any"/><line any_info="No Anys on this line!" content="" number="322" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)&#10;Unimported (x1)" content="            self.assertEqual({TopicPartition(KafkaChannelTest.test_channel_name, 0)}," number="323" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                             reader._data_consumer.assignment())" number="324" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x11)" content="            self.assertEqual(reader.get_context().get_group_name() + &quot;.&quot; + reader._data_topic_name," number="325" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                             reader._data_consumer.config[&quot;group_id&quot;])" number="326" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x9)" content="            self.assertEqual(reader.get_unique_name(), reader._data_consumer.config[&quot;client_id&quot;])" number="327" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="            self.assertEqual({" number="328" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x2)" content="                TopicPartition(KafkaChannelTest.test_channel_name + WriterStatusTopicNameExtension, 0)," number="329" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x2)" content="                TopicPartition(KafkaChannelTest.test_channel_name + ReaderStatusTopicNameExtension, 0)" number="330" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            }, reader._writer_status_consumer.assignment())" number="331" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x9)" content="            self.assertEqual(reader.get_unique_name() + &quot;.&quot; + reader._writer_status_topic_name," number="332" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                             reader._writer_status_consumer.config[&quot;group_id&quot;])" number="333" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x9)" content="            self.assertEqual(reader.get_unique_name(), reader._writer_status_consumer.config[&quot;client_id&quot;])" number="334" precision="any"/><line any_info="No Anys on this line!" content="" number="335" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_close_channel())" number="336" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_deletion())" number="337" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        except Exception as e:" number="338" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_close_channel()" number="339" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_resource_deletion()" number="340" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            self.fail(e)" number="341" precision="any"/><line any_info="No Anys on this line!" content="" number="342" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_invoke_open_channel_in_group_for_non_principal_expect_consumers_and_subscription_init(self):" number="343" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        operator = TestReaderOperator(&quot;reader&quot;)" number="344" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        operator.set_parameter(&quot;replicationFactor&quot;, 1)" number="345" precision="any"/><line any_info="No Anys on this line!" content="" number="346" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="347" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                                    context=operator.get_replica(0).input_port)" number="348" precision="any"/><line any_info="No Anys on this line!" content="" number="349" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="350" precision="any"/><line any_info="No Anys on this line!" content="" number="351" precision="empty"/><line any_info="No Anys on this line!" content="        try:" number="352" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_creation())" number="353" precision="any"/><line any_info="No Anys on this line!" content="" number="354" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(1)" number="355" precision="any"/><line any_info="No Anys on this line!" content="" number="356" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.is_resource_created())" number="357" precision="any"/><line any_info="No Anys on this line!" content="" number="358" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_open_channel())" number="359" precision="any"/><line any_info="No Anys on this line!" content="" number="360" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            self.assertIsNotNone(reader._data_consumer)" number="361" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            self.assertIsNotNone(reader._writer_status_consumer)" number="362" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            self.assertIsNotNone(reader._reader_status_producer)" number="363" precision="any"/><line any_info="No Anys on this line!" content="" number="364" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)&#10;Unimported (x1)" content="            self.assertEqual({TopicPartition(KafkaChannelTest.test_channel_name, 1)}," number="365" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                             reader._data_consumer.assignment())" number="366" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x11)" content="            self.assertEqual(reader.get_context().get_group_name() + &quot;.&quot; + reader._data_topic_name," number="367" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                             reader._data_consumer.config[&quot;group_id&quot;])" number="368" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x9)" content="            self.assertEqual(reader.get_unique_name(), reader._data_consumer.config[&quot;client_id&quot;])" number="369" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="            self.assertEqual({" number="370" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x2)" content="                TopicPartition(KafkaChannelTest.test_channel_name + WriterStatusTopicNameExtension, 0)" number="371" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            }, reader._writer_status_consumer.assignment())" number="372" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x9)" content="            self.assertEqual(reader.get_unique_name() + &quot;.&quot; + reader._writer_status_topic_name," number="373" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                             reader._writer_status_consumer.config[&quot;group_id&quot;])" number="374" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x9)" content="            self.assertEqual(reader.get_unique_name(), reader._writer_status_consumer.config[&quot;client_id&quot;])" number="375" precision="any"/><line any_info="No Anys on this line!" content="" number="376" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_close_channel())" number="377" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_deletion())" number="378" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        except Exception as e:" number="379" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_close_channel()" number="380" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_resource_deletion()" number="381" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            self.fail(e)" number="382" precision="any"/><line any_info="No Anys on this line!" content="" number="383" precision="empty"/><line any_info="No Anys on this line!" content="    def test_writer_invoke_resource_creation_without_provided_location_expect_error(self):" number="384" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        writer = KafkaChannelWriter(channel_name=KafkaChannelTest.test_channel_name," number="385" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankOutputPortPlugin(&quot;writer&quot;, schema=KafkaChannelTest.avro_schema_string))" number="386" precision="any"/><line any_info="No Anys on this line!" content="" number="387" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="        with self.assertRaises(AttributeError):" number="388" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_resource_creation()" number="389" precision="any"/><line any_info="No Anys on this line!" content="" number="390" precision="empty"/><line any_info="No Anys on this line!" content="    def test_writer_invoke_resource_creation_deletion_expect_no_operation(self):" number="391" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        writer = KafkaChannelWriter(channel_name=KafkaChannelTest.test_channel_name," number="392" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankOutputPortPlugin(&quot;writer&quot;, schema=KafkaChannelTest.avro_schema_string))" number="393" precision="any"/><line any_info="No Anys on this line!" content="" number="394" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        writer.set_location(KafkaChannelTest.bootstrap_url)" number="395" precision="any"/><line any_info="No Anys on this line!" content="" number="396" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(writer.invoke_resource_creation())" number="397" precision="any"/><line any_info="No Anys on this line!" content="" number="398" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="399" precision="any"/><line any_info="No Anys on this line!" content="" number="400" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(writer.invoke_resource_deletion())" number="401" precision="any"/><line any_info="No Anys on this line!" content="" number="402" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="403" precision="any"/><line any_info="No Anys on this line!" content="" number="404" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        existing_topics = KafkaChannelTest.test_admin_client.list_topics()" number="405" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertNotIn(KafkaChannelTest.test_channel_name, existing_topics)" number="406" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertNotIn(KafkaChannelTest.test_writer_status_name, existing_topics)" number="407" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertNotIn(KafkaChannelTest.test_reader_status_name, existing_topics)" number="408" precision="any"/><line any_info="No Anys on this line!" content="" number="409" precision="empty"/><line any_info="No Anys on this line!" content="    def test_writer_invoke_open_channel_without_resources_created_expect_unfinished(self):" number="410" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        writer = KafkaChannelWriter(channel_name=KafkaChannelTest.test_channel_name," number="411" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankOutputPortPlugin(&quot;writer&quot;, schema=KafkaChannelTest.avro_schema_string))" number="412" precision="any"/><line any_info="No Anys on this line!" content="" number="413" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        writer.set_location(KafkaChannelTest.bootstrap_url)" number="414" precision="any"/><line any_info="No Anys on this line!" content="" number="415" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(writer.invoke_resource_creation())" number="416" precision="any"/><line any_info="No Anys on this line!" content="" number="417" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="418" precision="any"/><line any_info="No Anys on this line!" content="" number="419" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(writer.invoke_resource_deletion())" number="420" precision="any"/><line any_info="No Anys on this line!" content="" number="421" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="422" precision="any"/><line any_info="No Anys on this line!" content="" number="423" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        existing_topics = KafkaChannelTest.test_admin_client.list_topics()" number="424" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertNotIn(KafkaChannelTest.test_channel_name, existing_topics)" number="425" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertNotIn(KafkaChannelTest.test_writer_status_name, existing_topics)" number="426" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        self.assertNotIn(KafkaChannelTest.test_reader_status_name, existing_topics)" number="427" precision="any"/><line any_info="No Anys on this line!" content="" number="428" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertFalse(writer.invoke_open_channel())" number="429" precision="any"/><line any_info="No Anys on this line!" content="" number="430" precision="empty"/><line any_info="No Anys on this line!" content="    def test_writer_invoke_open_channel_with_resources_created_expect_all_initialized(self):" number="431" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="432" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankInputPortPlugin(&quot;reader&quot;, schema=KafkaChannelTest.avro_schema_string))" number="433" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        writer = KafkaChannelWriter(channel_name=KafkaChannelTest.test_channel_name," number="434" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankOutputPortPlugin(&quot;writer&quot;, schema=KafkaChannelTest.avro_schema_string))" number="435" precision="any"/><line any_info="No Anys on this line!" content="" number="436" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="437" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        writer.set_location(KafkaChannelTest.bootstrap_url)" number="438" precision="any"/><line any_info="No Anys on this line!" content="" number="439" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_creation())" number="440" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(writer.invoke_resource_creation())" number="441" precision="any"/><line any_info="No Anys on this line!" content="" number="442" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="443" precision="any"/><line any_info="No Anys on this line!" content="" number="444" precision="empty"/><line any_info="No Anys on this line!" content="        try:" number="445" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_open_channel())" number="446" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            self.assertIsNotNone(writer._reader_status_consumer)" number="447" precision="any"/><line any_info="No Anys on this line!" content="" number="448" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)&#10;Unimported (x2)" content="            self.assertEqual({TopicPartition(KafkaChannelTest.test_channel_name + ReaderStatusTopicNameExtension, 0)}," number="449" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                             writer._reader_status_consumer.assignment())" number="450" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x9)" content="            self.assertEqual(writer.get_unique_name() + &quot;.&quot; + writer._reader_status_topic_name," number="451" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                             writer._reader_status_consumer.config[&quot;group_id&quot;])" number="452" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x9)" content="            self.assertEqual(writer.get_unique_name(), writer._reader_status_consumer.config[&quot;client_id&quot;])" number="453" precision="any"/><line any_info="No Anys on this line!" content="" number="454" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_close_channel())" number="455" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_resource_deletion())" number="456" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_deletion())" number="457" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        except Exception as e:" number="458" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_close_channel()" number="459" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_resource_deletion()" number="460" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_resource_deletion()" number="461" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            self.fail(e)" number="462" precision="any"/><line any_info="No Anys on this line!" content="" number="463" precision="empty"/><line any_info="No Anys on this line!" content="    def test_writer_round_robin_record_distribution_without_group(self):" number="464" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="465" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankInputPortPlugin(&quot;reader&quot;, schema=KafkaChannelTest.avro_schema_string))" number="466" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        writer = KafkaChannelWriter(channel_name=KafkaChannelTest.test_channel_name," number="467" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankOutputPortPlugin(&quot;writer&quot;, schema=KafkaChannelTest.avro_schema_string))" number="468" precision="any"/><line any_info="No Anys on this line!" content="" number="469" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="470" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        writer.set_location(KafkaChannelTest.bootstrap_url)" number="471" precision="any"/><line any_info="No Anys on this line!" content="" number="472" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_creation())" number="473" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(writer.invoke_resource_creation())" number="474" precision="any"/><line any_info="No Anys on this line!" content="" number="475" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="476" precision="any"/><line any_info="No Anys on this line!" content="" number="477" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="        test_consumer = KafkaConsumer(" number="478" precision="any"/><line any_info="No Anys on this line!" content="            group_id=&quot;test_writer_round_robin_record_distribution_without_group&quot;," number="479" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            bootstrap_servers=KafkaChannelTest.bootstrap_url" number="480" precision="any"/><line any_info="No Anys on this line!" content="        )" number="481" precision="empty"/><line any_info="No Anys on this line!" content="" number="482" precision="empty"/><line any_info="No Anys on this line!" content="        try:" number="483" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_open_channel())" number="484" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            self.assertEqual(1, writer._target_partition_count)" number="485" precision="any"/><line any_info="No Anys on this line!" content="" number="486" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            writer.invoke_write_records(KafkaChannelTest.generate_records(100))" number="487" precision="any"/><line any_info="No Anys on this line!" content="" number="488" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            self.assertEqual(0, writer._round_robin_partition_idx)" number="489" precision="any"/><line any_info="No Anys on this line!" content="" number="490" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x6)&#10;Unimported (x1)" content="            end_offsets = test_consumer.end_offsets([TopicPartition(KafkaChannelTest.test_channel_name, 0)])" number="491" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)&#10;Unimported (x1)" content="            self.assertEqual(100, end_offsets[TopicPartition(KafkaChannelTest.test_channel_name, 0)])" number="492" precision="any"/><line any_info="No Anys on this line!" content="" number="493" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_close_channel())" number="494" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_resource_deletion())" number="495" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_deletion())" number="496" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        except Exception as e:" number="497" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_close_channel()" number="498" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_resource_deletion()" number="499" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_resource_deletion()" number="500" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            self.fail(e)" number="501" precision="any"/><line any_info="No Anys on this line!" content="        finally:" number="502" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            test_consumer.close()" number="503" precision="any"/><line any_info="No Anys on this line!" content="" number="504" precision="empty"/><line any_info="No Anys on this line!" content="    def test_writer_round_robin_record_distribution_with_grouped_reader(self):" number="505" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        operator = TestReaderOperator(&quot;reader&quot;)" number="506" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        operator.set_parameter(&quot;replicationFactor&quot;, 4)" number="507" precision="any"/><line any_info="No Anys on this line!" content="" number="508" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="509" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="                                    context=operator.input_port)" number="510" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        writer = KafkaChannelWriter(channel_name=KafkaChannelTest.test_channel_name," number="511" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankOutputPortPlugin(&quot;writer&quot;, schema=KafkaChannelTest.avro_schema_string))" number="512" precision="any"/><line any_info="No Anys on this line!" content="" number="513" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="514" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        writer.set_location(KafkaChannelTest.bootstrap_url)" number="515" precision="any"/><line any_info="No Anys on this line!" content="" number="516" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_creation())" number="517" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(writer.invoke_resource_creation())" number="518" precision="any"/><line any_info="No Anys on this line!" content="" number="519" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="520" precision="any"/><line any_info="No Anys on this line!" content="" number="521" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="        test_consumer = KafkaConsumer(" number="522" precision="any"/><line any_info="No Anys on this line!" content="            group_id=&quot;test_writer_round_robin_record_distribution_without_group&quot;," number="523" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            bootstrap_servers=KafkaChannelTest.bootstrap_url" number="524" precision="any"/><line any_info="No Anys on this line!" content="        )" number="525" precision="empty"/><line any_info="No Anys on this line!" content="" number="526" precision="empty"/><line any_info="No Anys on this line!" content="        try:" number="527" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_open_channel())" number="528" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            self.assertEqual(5, writer._target_partition_count)" number="529" precision="any"/><line any_info="No Anys on this line!" content="" number="530" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            topic_partitions = [" number="531" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                TopicPartition(KafkaChannelTest.test_channel_name, 0)," number="532" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                TopicPartition(KafkaChannelTest.test_channel_name, 1)," number="533" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                TopicPartition(KafkaChannelTest.test_channel_name, 2)," number="534" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                TopicPartition(KafkaChannelTest.test_channel_name, 3)," number="535" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                TopicPartition(KafkaChannelTest.test_channel_name, 4)" number="536" precision="any"/><line any_info="No Anys on this line!" content="            ]" number="537" precision="empty"/><line any_info="No Anys on this line!" content="" number="538" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            writer.invoke_write_records(KafkaChannelTest.generate_records(100))" number="539" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(1)" number="540" precision="any"/><line any_info="No Anys on this line!" content="" number="541" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            end_offsets = test_consumer.end_offsets(topic_partitions)" number="542" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(20, end_offsets[topic_partitions[0]])" number="543" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(20, end_offsets[topic_partitions[1]])" number="544" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(20, end_offsets[topic_partitions[2]])" number="545" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(20, end_offsets[topic_partitions[3]])" number="546" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(20, end_offsets[topic_partitions[4]])" number="547" precision="any"/><line any_info="No Anys on this line!" content="" number="548" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            writer.invoke_write_records(KafkaChannelTest.generate_records(66))" number="549" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(1)" number="550" precision="any"/><line any_info="No Anys on this line!" content="" number="551" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            end_offsets = test_consumer.end_offsets(topic_partitions)" number="552" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(34, end_offsets[topic_partitions[0]])" number="553" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(33, end_offsets[topic_partitions[1]])" number="554" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(33, end_offsets[topic_partitions[2]])" number="555" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(33, end_offsets[topic_partitions[3]])" number="556" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(33, end_offsets[topic_partitions[4]])" number="557" precision="any"/><line any_info="No Anys on this line!" content="" number="558" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_close_channel())" number="559" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_resource_deletion())" number="560" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_deletion())" number="561" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        except Exception as e:" number="562" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_close_channel()" number="563" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_resource_deletion()" number="564" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_resource_deletion()" number="565" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            self.fail(e)" number="566" precision="any"/><line any_info="No Anys on this line!" content="        finally:" number="567" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            test_consumer.close()" number="568" precision="any"/><line any_info="No Anys on this line!" content="" number="569" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_consumer_lag_calculation_in_group(self):" number="570" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        operator = TestReaderOperator(&quot;reader&quot;)" number="571" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        operator.set_parameter(&quot;replicationFactor&quot;, 1)" number="572" precision="any"/><line any_info="No Anys on this line!" content="" number="573" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="574" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="                                    context=operator.input_port)" number="575" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader_1 = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="576" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="                                      context=operator.get_replica(0).input_port)" number="577" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        writer = KafkaChannelWriter(channel_name=KafkaChannelTest.test_channel_name," number="578" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankOutputPortPlugin(&quot;writer&quot;, schema=KafkaChannelTest.avro_schema_string))" number="579" precision="any"/><line any_info="No Anys on this line!" content="" number="580" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        reader.invoke_configure_channel({&quot;max_poll_records&quot;: 500})" number="581" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        reader_1.invoke_configure_channel({&quot;max_poll_records&quot;: 500})" number="582" precision="any"/><line any_info="No Anys on this line!" content="" number="583" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="584" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader_1.set_location(KafkaChannelTest.bootstrap_url)" number="585" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        writer.set_location(KafkaChannelTest.bootstrap_url)" number="586" precision="any"/><line any_info="No Anys on this line!" content="" number="587" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_creation())" number="588" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader_1.invoke_resource_creation())" number="589" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(writer.invoke_resource_creation())" number="590" precision="any"/><line any_info="No Anys on this line!" content="" number="591" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="592" precision="any"/><line any_info="No Anys on this line!" content="" number="593" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="        test_consumer = KafkaConsumer(" number="594" precision="any"/><line any_info="No Anys on this line!" content="            group_id=&quot;test_writer_round_robin_record_distribution_without_group&quot;," number="595" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            bootstrap_servers=KafkaChannelTest.bootstrap_url" number="596" precision="any"/><line any_info="No Anys on this line!" content="        )" number="597" precision="empty"/><line any_info="No Anys on this line!" content="" number="598" precision="empty"/><line any_info="No Anys on this line!" content="        try:" number="599" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_open_channel())" number="600" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader_1.invoke_open_channel())" number="601" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_open_channel())" number="602" precision="any"/><line any_info="No Anys on this line!" content="" number="603" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            self.assertEqual(2, writer._target_partition_count)" number="604" precision="any"/><line any_info="No Anys on this line!" content="" number="605" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            topic_partitions = [" number="606" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                TopicPartition(KafkaChannelTest.test_channel_name, 0)," number="607" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                TopicPartition(KafkaChannelTest.test_channel_name, 1)," number="608" precision="any"/><line any_info="No Anys on this line!" content="            ]" number="609" precision="empty"/><line any_info="No Anys on this line!" content="" number="610" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            writer.invoke_write_records(KafkaChannelTest.generate_records(100))" number="611" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(1)" number="612" precision="any"/><line any_info="No Anys on this line!" content="" number="613" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            end_offsets = test_consumer.end_offsets(topic_partitions)" number="614" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(50, end_offsets[topic_partitions[0]])" number="615" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(50, end_offsets[topic_partitions[1]])" number="616" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(50, reader.get_consumer_lag())" number="617" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(50, reader_1.get_consumer_lag())" number="618" precision="any"/><line any_info="No Anys on this line!" content="" number="619" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(50, len(reader.invoke_read_records()))" number="620" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(50, len(reader_1.invoke_read_records()))" number="621" precision="any"/><line any_info="No Anys on this line!" content="" number="622" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(0, reader.get_consumer_lag())" number="623" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(0, reader_1.get_consumer_lag())" number="624" precision="any"/><line any_info="No Anys on this line!" content="" number="625" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            writer.invoke_write_records(KafkaChannelTest.generate_records(50))" number="626" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(1)" number="627" precision="any"/><line any_info="No Anys on this line!" content="" number="628" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(25, reader.get_consumer_lag())" number="629" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(25, reader_1.get_consumer_lag())" number="630" precision="any"/><line any_info="No Anys on this line!" content="" number="631" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            end_offsets = test_consumer.end_offsets(topic_partitions)" number="632" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(75, end_offsets[topic_partitions[0]])" number="633" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(75, end_offsets[topic_partitions[1]])" number="634" precision="any"/><line any_info="No Anys on this line!" content="" number="635" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(25, len(reader.invoke_read_records()))" number="636" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(25, len(reader_1.invoke_read_records()))" number="637" precision="any"/><line any_info="No Anys on this line!" content="" number="638" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(0, reader.get_consumer_lag())" number="639" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(0, reader_1.get_consumer_lag())" number="640" precision="any"/><line any_info="No Anys on this line!" content="" number="641" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_close_channel())" number="642" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader_1.invoke_close_channel())" number="643" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_close_channel())" number="644" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_resource_deletion())" number="645" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader_1.invoke_resource_deletion())" number="646" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_deletion())" number="647" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        except Exception as e:" number="648" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_close_channel()" number="649" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader_1.invoke_close_channel()" number="650" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_close_channel()" number="651" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_resource_deletion()" number="652" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader_1.invoke_resource_deletion()" number="653" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_resource_deletion()" number="654" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            self.fail(e)" number="655" precision="any"/><line any_info="No Anys on this line!" content="        finally:" number="656" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            test_consumer.close()" number="657" precision="any"/><line any_info="No Anys on this line!" content="" number="658" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_without_offset_commit_restart_from_beginning(self):" number="659" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="660" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankInputPortPlugin(&quot;reader&quot;, schema=KafkaChannelTest.avro_schema_string))" number="661" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        writer = KafkaChannelWriter(channel_name=KafkaChannelTest.test_channel_name," number="662" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankOutputPortPlugin(&quot;writer&quot;, schema=KafkaChannelTest.avro_schema_string))" number="663" precision="any"/><line any_info="No Anys on this line!" content="" number="664" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        reader.invoke_configure_channel({&quot;max_poll_records&quot;: 10})" number="665" precision="any"/><line any_info="No Anys on this line!" content="" number="666" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="667" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        writer.set_location(KafkaChannelTest.bootstrap_url)" number="668" precision="any"/><line any_info="No Anys on this line!" content="" number="669" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_creation())" number="670" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(writer.invoke_resource_creation())" number="671" precision="any"/><line any_info="No Anys on this line!" content="" number="672" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="673" precision="any"/><line any_info="No Anys on this line!" content="" number="674" precision="empty"/><line any_info="No Anys on this line!" content="        try:" number="675" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_open_channel())" number="676" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.set_initial_record_offset_auto()" number="677" precision="any"/><line any_info="No Anys on this line!" content="" number="678" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_open_channel())" number="679" precision="any"/><line any_info="No Anys on this line!" content="" number="680" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            writer.invoke_write_records(KafkaChannelTest.generate_records(10))" number="681" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(0.2)" number="682" precision="any"/><line any_info="No Anys on this line!" content="" number="683" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(10, len(reader.invoke_read_records()))" number="684" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(10, reader.get_read_record_count())" number="685" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(10, reader.get_read_record_offset())" number="686" precision="any"/><line any_info="No Anys on this line!" content="" number="687" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_close_channel())" number="688" precision="any"/><line any_info="No Anys on this line!" content="" number="689" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="            reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="690" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)&#10;Unimported (x1)" content="                                        context=BlankInputPortPlugin(&quot;reader&quot;," number="691" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="                                                                     schema=KafkaChannelTest.avro_schema_string))" number="692" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            reader.set_location(KafkaChannelTest.bootstrap_url)" number="693" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_configure_channel({&quot;max_poll_records&quot;: 10})" number="694" precision="any"/><line any_info="No Anys on this line!" content="" number="695" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_creation())" number="696" precision="any"/><line any_info="No Anys on this line!" content="" number="697" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(1)" number="698" precision="any"/><line any_info="No Anys on this line!" content="" number="699" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_open_channel())" number="700" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.set_initial_record_offset_auto()" number="701" precision="any"/><line any_info="No Anys on this line!" content="" number="702" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(10, len(reader.invoke_read_records()))" number="703" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(10, reader.get_read_record_count())" number="704" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(10, reader.get_read_record_offset())" number="705" precision="any"/><line any_info="No Anys on this line!" content="" number="706" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_close_channel())" number="707" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_close_channel())" number="708" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_resource_deletion())" number="709" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_deletion())" number="710" precision="any"/><line any_info="No Anys on this line!" content="" number="711" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        except Exception as e:" number="712" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_close_channel()" number="713" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_close_channel()" number="714" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_resource_deletion()" number="715" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_resource_deletion()" number="716" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            self.fail(e)" number="717" precision="any"/><line any_info="No Anys on this line!" content="" number="718" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_with_custom_offset_commit_restart_from_custom_offset(self):" number="719" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="720" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankInputPortPlugin(&quot;reader&quot;, schema=KafkaChannelTest.avro_schema_string))" number="721" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        writer = KafkaChannelWriter(channel_name=KafkaChannelTest.test_channel_name," number="722" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankOutputPortPlugin(&quot;writer&quot;, schema=KafkaChannelTest.avro_schema_string))" number="723" precision="any"/><line any_info="No Anys on this line!" content="" number="724" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        reader.invoke_configure_channel({&quot;max_poll_records&quot;: 10})" number="725" precision="any"/><line any_info="No Anys on this line!" content="" number="726" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="727" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        writer.set_location(KafkaChannelTest.bootstrap_url)" number="728" precision="any"/><line any_info="No Anys on this line!" content="" number="729" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_creation())" number="730" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(writer.invoke_resource_creation())" number="731" precision="any"/><line any_info="No Anys on this line!" content="" number="732" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="733" precision="any"/><line any_info="No Anys on this line!" content="" number="734" precision="empty"/><line any_info="No Anys on this line!" content="        try:" number="735" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_open_channel())" number="736" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.set_initial_record_offset_auto()" number="737" precision="any"/><line any_info="No Anys on this line!" content="" number="738" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_open_channel())" number="739" precision="any"/><line any_info="No Anys on this line!" content="" number="740" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            writer.invoke_write_records(KafkaChannelTest.generate_records(10))" number="741" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(0.2)" number="742" precision="any"/><line any_info="No Anys on this line!" content="" number="743" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(10, len(reader.invoke_read_records()))" number="744" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(10, reader.get_read_record_count())" number="745" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(10, reader.get_read_record_offset())" number="746" precision="any"/><line any_info="No Anys on this line!" content="" number="747" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_commit_offset(5)" number="748" precision="any"/><line any_info="No Anys on this line!" content="" number="749" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_close_channel())" number="750" precision="any"/><line any_info="No Anys on this line!" content="" number="751" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="            reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="752" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)&#10;Unimported (x1)" content="                                        context=BlankInputPortPlugin(&quot;reader&quot;," number="753" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="                                                                     schema=KafkaChannelTest.avro_schema_string))" number="754" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            reader.set_location(KafkaChannelTest.bootstrap_url)" number="755" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_configure_channel({&quot;max_poll_records&quot;: 10})" number="756" precision="any"/><line any_info="No Anys on this line!" content="" number="757" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_creation())" number="758" precision="any"/><line any_info="No Anys on this line!" content="" number="759" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(1)" number="760" precision="any"/><line any_info="No Anys on this line!" content="" number="761" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_open_channel())" number="762" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.set_initial_record_offset_auto()" number="763" precision="any"/><line any_info="No Anys on this line!" content="" number="764" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(5, len(reader.invoke_read_records()))" number="765" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(5, reader.get_read_record_count())" number="766" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(10, reader.get_read_record_offset())" number="767" precision="any"/><line any_info="No Anys on this line!" content="" number="768" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            writer.invoke_write_records(KafkaChannelTest.generate_records(10))" number="769" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(0.2)" number="770" precision="any"/><line any_info="No Anys on this line!" content="" number="771" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(10, len(reader.invoke_read_records()))" number="772" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(15, reader.get_read_record_count())" number="773" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(20, reader.get_read_record_offset())" number="774" precision="any"/><line any_info="No Anys on this line!" content="" number="775" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_close_channel())" number="776" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_close_channel())" number="777" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_resource_deletion())" number="778" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_deletion())" number="779" precision="any"/><line any_info="No Anys on this line!" content="" number="780" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        except Exception as e:" number="781" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_close_channel()" number="782" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_close_channel()" number="783" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_resource_deletion()" number="784" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_resource_deletion()" number="785" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            self.fail(e)" number="786" precision="any"/><line any_info="No Anys on this line!" content="" number="787" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_with_current_read_offset_commit_restart_from_current_offset(self):" number="788" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="789" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankInputPortPlugin(&quot;reader&quot;, schema=KafkaChannelTest.avro_schema_string))" number="790" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        writer = KafkaChannelWriter(channel_name=KafkaChannelTest.test_channel_name," number="791" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankOutputPortPlugin(&quot;writer&quot;, schema=KafkaChannelTest.avro_schema_string))" number="792" precision="any"/><line any_info="No Anys on this line!" content="" number="793" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        reader.invoke_configure_channel({&quot;max_poll_records&quot;: 10})" number="794" precision="any"/><line any_info="No Anys on this line!" content="" number="795" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="796" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        writer.set_location(KafkaChannelTest.bootstrap_url)" number="797" precision="any"/><line any_info="No Anys on this line!" content="" number="798" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_creation())" number="799" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(writer.invoke_resource_creation())" number="800" precision="any"/><line any_info="No Anys on this line!" content="" number="801" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="802" precision="any"/><line any_info="No Anys on this line!" content="" number="803" precision="empty"/><line any_info="No Anys on this line!" content="        try:" number="804" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_open_channel())" number="805" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.set_initial_record_offset_auto()" number="806" precision="any"/><line any_info="No Anys on this line!" content="" number="807" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_open_channel())" number="808" precision="any"/><line any_info="No Anys on this line!" content="" number="809" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            writer.invoke_write_records(KafkaChannelTest.generate_records(10))" number="810" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(5)" number="811" precision="any"/><line any_info="No Anys on this line!" content="" number="812" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(10, len(reader.invoke_read_records()))" number="813" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(10, reader.get_read_record_count())" number="814" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(10, reader.get_read_record_offset())" number="815" precision="any"/><line any_info="No Anys on this line!" content="" number="816" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_commit_current_read_offset()" number="817" precision="any"/><line any_info="No Anys on this line!" content="" number="818" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_close_channel())" number="819" precision="any"/><line any_info="No Anys on this line!" content="" number="820" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="            reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="821" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)&#10;Unimported (x1)" content="                                        context=BlankInputPortPlugin(&quot;reader&quot;," number="822" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="                                                                     schema=KafkaChannelTest.avro_schema_string))" number="823" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="            reader.set_location(KafkaChannelTest.bootstrap_url)" number="824" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_configure_channel({&quot;max_poll_records&quot;: 10})" number="825" precision="any"/><line any_info="No Anys on this line!" content="" number="826" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_creation())" number="827" precision="any"/><line any_info="No Anys on this line!" content="" number="828" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(1)" number="829" precision="any"/><line any_info="No Anys on this line!" content="" number="830" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_open_channel())" number="831" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.set_initial_record_offset_auto()" number="832" precision="any"/><line any_info="No Anys on this line!" content="" number="833" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(0, len(reader.invoke_read_records()))" number="834" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(0, reader.get_read_record_count())" number="835" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(10, reader.get_read_record_offset())" number="836" precision="any"/><line any_info="No Anys on this line!" content="" number="837" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            writer.invoke_write_records(KafkaChannelTest.generate_records(10))" number="838" precision="any"/><line any_info="No Anys on this line!" content="" number="839" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(2)" number="840" precision="any"/><line any_info="No Anys on this line!" content="" number="841" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_close_channel())" number="842" precision="any"/><line any_info="No Anys on this line!" content="" number="843" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(10, len(reader.invoke_read_records()))" number="844" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(10, reader.get_read_record_count())" number="845" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(20, reader.get_read_record_offset())" number="846" precision="any"/><line any_info="No Anys on this line!" content="" number="847" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_close_channel())" number="848" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_resource_deletion())" number="849" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_deletion())" number="850" precision="any"/><line any_info="No Anys on this line!" content="" number="851" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        except Exception as e:" number="852" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_close_channel()" number="853" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_close_channel()" number="854" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_resource_deletion()" number="855" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_resource_deletion()" number="856" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            self.fail(e)" number="857" precision="any"/><line any_info="No Anys on this line!" content="" number="858" precision="empty"/><line any_info="No Anys on this line!" content="    def test_reader_with_invalid_offset_commit_expect_error(self):" number="859" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        reader = KafkaChannelReader(channel_name=KafkaChannelTest.test_channel_name," number="860" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankInputPortPlugin(&quot;reader&quot;, schema=KafkaChannelTest.avro_schema_string))" number="861" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)&#10;Unimported (x1)" content="        writer = KafkaChannelWriter(channel_name=KafkaChannelTest.test_channel_name," number="862" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x2)&#10;Unimported (x1)" content="                                    context=BlankOutputPortPlugin(&quot;writer&quot;, schema=KafkaChannelTest.avro_schema_string))" number="863" precision="any"/><line any_info="No Anys on this line!" content="" number="864" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="        reader.invoke_configure_channel({&quot;max_poll_records&quot;: 10})" number="865" precision="any"/><line any_info="No Anys on this line!" content="" number="866" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        reader.set_location(KafkaChannelTest.bootstrap_url)" number="867" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x4)" content="        writer.set_location(KafkaChannelTest.bootstrap_url)" number="868" precision="any"/><line any_info="No Anys on this line!" content="" number="869" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(reader.invoke_resource_creation())" number="870" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="        self.assertTrue(writer.invoke_resource_creation())" number="871" precision="any"/><line any_info="No Anys on this line!" content="" number="872" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        time.sleep(1)" number="873" precision="any"/><line any_info="No Anys on this line!" content="" number="874" precision="empty"/><line any_info="No Anys on this line!" content="        try:" number="875" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_open_channel())" number="876" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.set_initial_record_offset_auto()" number="877" precision="any"/><line any_info="No Anys on this line!" content="" number="878" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_open_channel())" number="879" precision="any"/><line any_info="No Anys on this line!" content="" number="880" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            writer.invoke_write_records(KafkaChannelTest.generate_records(10))" number="881" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="            time.sleep(2)" number="882" precision="any"/><line any_info="No Anys on this line!" content="" number="883" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="            with self.assertRaises(ValueError):" number="884" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="                reader.invoke_commit_offset(10)" number="885" precision="any"/><line any_info="No Anys on this line!" content="" number="886" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x6)" content="            self.assertEqual(10, len(reader.invoke_read_records()))" number="887" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(10, reader.get_read_record_count())" number="888" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertEqual(10, reader.get_read_record_offset())" number="889" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_commit_offset(10)" number="890" precision="any"/><line any_info="No Anys on this line!" content="" number="891" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x2)" content="            with self.assertRaises(ValueError):" number="892" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="                reader.invoke_commit_offset(11)" number="893" precision="any"/><line any_info="No Anys on this line!" content="" number="894" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_close_channel())" number="895" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_close_channel())" number="896" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(writer.invoke_resource_deletion())" number="897" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x5)" content="            self.assertTrue(reader.invoke_resource_deletion())" number="898" precision="any"/><line any_info="No Anys on this line!" content="" number="899" precision="empty"/><line any_info="Any Types on this line: &#10;Unannotated (x1)" content="        except Exception as e:" number="900" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_close_channel()" number="901" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_close_channel()" number="902" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            writer.invoke_resource_deletion()" number="903" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            reader.invoke_resource_deletion()" number="904" precision="any"/><line any_info="Any Types on this line: &#10;Unannotated (x3)" content="            self.fail(e)" number="905" precision="any"/></mypy-report-file>