

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Models &mdash; pypz  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=888ff710"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Parameters" href="parameters.html" />
    <link rel="prev" title="Changelog" href="../general/changelog.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            pypz
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/changelog.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#instances">Instances</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#attributes">Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generic-type">Generic Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#metaclass">Metaclass</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-transfer-object-dto">Data Transfer Object (DTO)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#working-with-yaml">Working with YAML</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#instance-groups">Instance Groups</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pipeline">Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="#operator">Operator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#expected-parameters">Expected Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#operatorimagename-default-none"><em>operatorImageName</em> (default: None)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#replicationfactor-default-0"><em>replicationFactor</em> (default: 0)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#connections">Connections</a></li>
<li class="toctree-l3"><a class="reference internal" href="#replication">Replication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#methods">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logging">Logging</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#plugins">Plugins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_transfer.html">Data Transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="executor.html">Executor</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployer.html">Deployer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../plugins/kafka_io.html">Kafka IO Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/rmq_io.html">RabbitMQ IO Plugin</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deployers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../deployers/kubernetes.html">Kubernetes Deployer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sniffer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sniffer/overview.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guides/ht_create_pipeline.html">How to create a pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/ht_debug_in_operator.html">How to debug in a deployed operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/ht_contribute.html">Contributor’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/ht_develop.html">Developer’s Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/lazlowa/pypz-python">Source Code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/lazlowa/pypz-starter-template">Starter Template Project</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/lazlowa/pypz-examples">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pypz</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Models</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/core/models.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="models">
<span id="id1"></span><h1>Models<a class="headerlink" href="#models" title="Link to this heading"></a></h1>
<p>There is a multi-layered design behind <em>pypz</em> with the following layers from top to bottom: pipeline,
operator, plugin. As you can see, in the top layer there is the pipeline, which contains the operators
with the actual business logic. It is possible to enhance the functionalities of the operators via
plugins e.g., the port plugins by which the operators can transfer data between each other or the
logger plugins that enables the operator to send logs to the specified targets. The plugins are on the lowest level.</p>
<figure class="align-center" id="id4">
<img alt="Basic pipeline" src="../_images/basic_pipeline.png" />
<figcaption>
<p><span class="caption-text">Basic pipeline</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="instances">
<span id="id2"></span><h2>Instances<a class="headerlink" href="#instances" title="Link to this heading"></a></h2>
<p>Each entities in <em>pypz</em> (pipelines, operators, plugins) are represented as instances in runtime.
The blueprints of the instances are called specs and are represented as classes in the code.
In other words, you can consider the specs as the classes and the instances as the objects
created from the classes. This design enables <em>pypz</em> to model the pipelines as code.
The <a class="reference internal" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.Instance" title="pypz.core.specs.instance.Instance"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instance</span></code></a> class itself is the base for
every other specs. It contains all the necessary logic and feature that is required by the mentioned design.</p>
<figure class="align-default" id="id5">
<span id="inheritance-diagram"></span><div class="graphviz"><img src="../_images/inheritance-6d6b9584ab6da2bc303c8cf46d2cfc39c67ad238.png" alt="Inheritance diagram of pypz.core.specs.pipeline.Pipeline, pypz.core.specs.operator.Operator, pypz.core.specs.plugin.LoggerPlugin, pypz.core.specs.plugin.ExtendedPlugin, pypz.core.specs.plugin.ServicePlugin, pypz.core.specs.plugin.InputPortPlugin, pypz.core.specs.plugin.OutputPortPlugin" usemap="#inheritance70fd585c5a" class="inheritance graphviz" /></div>
<map id="inheritance70fd585c5a" name="inheritance70fd585c5a">
<area shape="poly" id="node2" href="../indexes/core/pypz.core.commons.loggers.html#pypz.core.commons.loggers.ContextLoggerInterface" target="_top" title="This interface provides the necessary methods to be able to implement" alt="" coords="531,261,520,254,488,247,438,242,375,238,305,237,236,238,173,242,123,247,91,254,80,261,91,269,123,276,173,281,236,285,305,286,375,285,438,281,488,276,520,269"/>
<area shape="poly" id="node3" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.ExtendedPlugin" target="_top" title="This interface extends the normal plugin&#39;s lifecycle. The methods" alt="" coords="1407,653,1399,645,1378,639,1344,633,1302,630,1255,629,1209,630,1166,633,1133,639,1111,645,1104,653,1111,661,1133,667,1166,673,1209,676,1255,677,1302,676,1344,673,1378,667,1399,661"/>
<area shape="poly" id="node4" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.Plugin" target="_top" title="This interface has the only purpose to separate the plugin interfaces" alt="" coords="774,458,771,450,761,443,747,438,729,434,708,433,688,434,670,438,655,443,646,450,643,458,646,465,655,472,670,477,688,481,708,482,729,481,747,477,761,472,771,465"/>
<area shape="poly" id="node7" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.InputPortPlugin" target="_top" title="This plugin interface allows to implement data transfer input port for an operator." alt="" coords="1021,849,1014,842,993,835,960,829,918,826,872,825,826,826,785,829,752,835,731,842,723,849,731,857,752,864,785,869,826,872,872,874,918,872,960,869,993,864,1014,857"/>
<area shape="poly" id="node8" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.PortPlugin" target="_top" title="This plugin interface allows to implement common methods for" alt="" coords="810,653,805,645,791,639,768,633,740,630,708,629,677,630,649,633,626,639,612,645,607,653,612,661,626,667,649,673,677,676,708,677,740,676,768,673,791,667,805,661"/>
<area shape="poly" id="node9" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.Instance" target="_top" title="This class represents the instance specs that serves as base for" alt="" coords="1231,261,1227,254,1214,247,1195,242,1171,238,1144,237,1118,238,1093,242,1074,247,1062,254,1058,261,1062,269,1074,276,1093,281,1118,285,1144,286,1171,285,1195,281,1214,276,1227,269"/>
<area shape="poly" id="node10" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.InstanceGroup" target="_top" title="This class provides methods to access instance group related information. It can be" alt="" coords="982,261,975,254,955,247,924,242,884,238,840,237,796,238,757,242,725,247,705,254,698,261,705,269,725,276,757,281,796,285,840,286,884,285,924,281,955,276,975,269"/>
<area shape="poly" id="node11" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.LoggerPlugin" target="_top" title="This addon interface allows to implement different logging technologies" alt="" coords="592,653,586,645,567,639,539,633,503,630,464,629,424,630,389,633,360,639,342,645,336,653,342,661,360,667,389,673,424,676,464,677,503,676,539,673,567,667,586,661"/>
<area shape="poly" id="node12" href="../indexes/core/pypz.core.specs.operator.html#pypz.core.specs.operator.Operator" target="_top" title="This class represents the operator instance specs. This class shall be used" alt="" coords="1116,458,1112,450,1099,443,1078,438,1053,434,1024,433,996,434,971,438,950,443,937,450,933,458,937,465,950,472,971,477,996,481,1024,482,1053,481,1078,477,1099,472,1112,465"/>
<area shape="poly" id="node13" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.OutputPortPlugin" target="_top" title="This plugin interface allows to implement data transfer output port for an operator." alt="" coords="709,849,701,842,678,835,641,829,595,826,544,825,493,826,447,829,411,835,387,842,379,849,387,857,411,864,447,869,493,872,544,874,595,872,641,869,678,864,701,857"/>
<area shape="poly" id="node15" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.ServicePlugin" target="_top" title="This plugin interface allows to implement a service. Services are special entities" alt="" coords="1089,653,1083,645,1064,639,1035,633,998,630,957,629,916,630,879,633,850,639,831,645,824,653,831,661,850,667,879,673,916,676,957,677,998,676,1035,673,1064,667,1083,661"/>
<area shape="poly" id="node5" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.RegisteredInterface" target="_top" title="This is a marker interface with the sole purpose to identify the native specs interfaces." alt="" coords="1533,65,1524,57,1497,51,1455,45,1403,42,1345,41,1286,42,1234,45,1192,51,1166,57,1156,65,1166,73,1192,79,1234,85,1286,88,1345,90,1403,88,1455,85,1497,79,1524,73"/>
<area shape="poly" id="node14" href="../indexes/core/pypz.core.specs.pipeline.html#pypz.core.specs.pipeline.Pipeline" target="_top" title="This class represents the pipeline instance specs. A pipeline is actually a" alt="" coords="1292,458,1288,450,1276,443,1259,438,1236,434,1211,433,1186,434,1164,438,1146,443,1134,450,1130,458,1134,465,1146,472,1164,477,1186,481,1211,482,1236,481,1259,477,1276,472,1288,465"/>
</map><figcaption>
<p><span class="caption-text">Inheritance diagram</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The <a class="reference internal" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.Instance" title="pypz.core.specs.instance.Instance"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instance</span></code></a> class is designed in a way that it could
be used on its own. However, the <a class="reference internal" href="../indexes/core/pypz.core.specs.pipeline.html#pypz.core.specs.pipeline.Pipeline" title="pypz.core.specs.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>,
<a class="reference internal" href="../indexes/core/pypz.core.specs.operator.html#pypz.core.specs.operator.Operator" title="pypz.core.specs.operator.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a> and <a class="reference internal" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.Plugin" title="pypz.core.specs.plugin.Plugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Plugin</span></code></a>
classes are specializing and somewhat restricting the base Instance class in a way that is necessary for <em>pypz</em>.</p>
<section id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Link to this heading"></a></h3>
<p>Basically an instance has the following attributes:</p>
<ul class="simple">
<li><p><strong>name</strong> (required), which identifies the instance in runtime</p></li>
<li><p>parameters</p></li>
<li><p><strong>dependencies</strong> to other instances</p></li>
<li><p><strong>nested instances</strong> i.e., other instances attached to the current instance’s context e.g., an operator is a nested instance to a pipeline</p></li>
<li><p><strong>context instance</strong> i.e., the parent instance e.g., the pipeline is the context of an operator</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The name of the instance can be provided either as constructor argument or if it has a context and
the argument is omitted, then the name of instance will be the name of the variable.</p>
</div>
</section>
<section id="generic-type">
<h3>Generic Type<a class="headerlink" href="#generic-type" title="Link to this heading"></a></h3>
<p>The <a class="reference internal" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.Instance" title="pypz.core.specs.instance.Instance"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instance</span></code></a> class is a generic class, where the generic attribute
describes the expected type of the nested instances. It is important, since at construction time all
attributes will be scanned and if one of them has the type of the expected nested instance type, then
it will be automatically identified as a nested instance.</p>
</section>
<section id="metaclass">
<span id="instance-metaclass"></span><h3>Metaclass<a class="headerlink" href="#metaclass" title="Link to this heading"></a></h3>
<p>Notice that a custom metaclass is used (<a class="reference internal" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.InterceptedInstance" title="pypz.core.specs.instance.InterceptedInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">pypz.core.specs.instance.InterceptedInstance</span></code></a>)
to be able to intercept the creation of the Instance object. This is necessary to allow to perform potential
instance name deduction from variable name and some other checks.</p>
</section>
<section id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading"></a></h3>
<p>It is possible to define dependencies between instances at runtime. However, you should be aware
that the meaning of the dependencies are defined by the runtime context i.e., just by defining
them has no effect. For example, the operator executor uses the dependency definitions of the plugins to
build a call order list, which then will determine, what plugin runs when.</p>
</section>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<p>You can define expected parameters for your <a class="reference internal" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.Instance" title="pypz.core.specs.instance.Instance"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instance</span></code></a> spec.
You can expect both required and optional parameters to be set for your instance.
Check the <a class="reference internal" href="parameters.html#parameters"><span class="std std-ref">parameters section</span></a> for a more detailed explanation.</p>
</section>
<section id="data-transfer-object-dto">
<h3>Data Transfer Object (DTO)<a class="headerlink" href="#data-transfer-object-dto" title="Link to this heading"></a></h3>
<p>If you want to transfer instances to outside of the current process, you need to convert it
into a representation, which can then be serialized. This representation is an additional
model called the DTO. By having an intermediate model, we can ensure that only those information
are transmitted that is really necessary to be able to reconstruct an instance object.</p>
<p>To get the DTO of an Instance, you can use:</p>
<p><a class="reference internal" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.Instance.get_dto" title="pypz.core.specs.instance.Instance.get_dto"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pypz.core.specs.instance.Instance.get_dto()</span></code></a></p>
<p>To construct an Instance object from a DTO, you can use:</p>
<p><a class="reference internal" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.Instance.create_from_dto" title="pypz.core.specs.instance.Instance.create_from_dto"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pypz.core.specs.instance.Instance.create_from_dto()</span></code></a></p>
<section id="working-with-yaml">
<h4>Working with YAML<a class="headerlink" href="#working-with-yaml" title="Link to this heading"></a></h4>
<p>Currently <em>pypz</em> serializes the DTOs into YAML, since it is human readable and provides features
out of the box, which JSON lacks the support of (e.g., interpreting sets).</p>
<p>To convert an instance into a YAML string, you can use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">yaml_string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
</pre></div>
</div>
<p>In the background, the instance will be converted into a DTO, which then will be converted into a YAML string.</p>
<p>To construct an instance from a YAML string, you can use:</p>
<p><a class="reference internal" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.Instance.create_from_string" title="pypz.core.specs.instance.Instance.create_from_string"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pypz.core.specs.instance.Instance.create_from_string()</span></code></a></p>
<p>You can find a usage example <a class="reference external" href="https://github.com/lazlowa/pypz-examples">here</a></p>
</section>
</section>
<section id="instance-groups">
<span id="instance-group"></span><h3>Instance Groups<a class="headerlink" href="#instance-groups" title="Link to this heading"></a></h3>
<p>Instances can be grouped together. For example, if you <a class="reference internal" href="#operator-replication"><span class="std std-ref">replicate</span></a> an operator, then
you are creating a group of operators. The original instance in this case is called “principal”.</p>
<p>The class <a class="reference internal" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.InstanceGroup" title="pypz.core.specs.instance.InstanceGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">pypz.core.specs.instance.InstanceGroup</span></code></a> provides the methods to access useful group related information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notice that this interface shall be implemented by the instance types that can form groups e.g. Operator and Plugin.</p>
</div>
</section>
</section>
<section id="pipeline">
<h2>Pipeline<a class="headerlink" href="#pipeline" title="Link to this heading"></a></h2>
<p>As its name suggests, the <a class="reference internal" href="../indexes/core/pypz.core.specs.pipeline.html#pypz.core.specs.pipeline.Pipeline" title="pypz.core.specs.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a> class represents a
pipeline in <em>pypz</em>. Its nested type is defined as the <a class="reference internal" href="../indexes/core/pypz.core.specs.operator.html#pypz.core.specs.operator.Operator" title="pypz.core.specs.operator.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a> class.
Basically it does not alter or extend the functionality of the <a class="reference internal" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.Instance" title="pypz.core.specs.instance.Instance"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instance</span></code></a>
class, since unlike the operators and plugins, the pipeline is a virtual organization of the Operators.</p>
</section>
<section id="operator">
<h2>Operator<a class="headerlink" href="#operator" title="Link to this heading"></a></h2>
<p>The <a class="reference internal" href="../indexes/core/pypz.core.specs.operator.html#pypz.core.specs.operator.Operator" title="pypz.core.specs.operator.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a> class represents the operator in <em>pypz</em>.
Its nested type is defined as the <a class="reference internal" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.Plugin" title="pypz.core.specs.plugin.Plugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Plugin</span></code></a> class.
The <a class="reference internal" href="../indexes/core/pypz.core.specs.operator.html#pypz.core.specs.operator.Operator" title="pypz.core.specs.operator.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a> is the most important model, since it contains
the implementation of the business logic. In addition to the <a class="reference internal" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.Instance" title="pypz.core.specs.instance.Instance"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instance</span></code></a>
class, the Operator class provides the following features:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#operator-connection"><span class="std std-ref">operator connection</span></a></p></li>
<li><p><a class="reference internal" href="#operator-replication"><span class="std std-ref">operator replication</span></a></p></li>
<li><p><a class="reference internal" href="#operator-methods"><span class="std std-ref">methods</span></a> to implement the business logic</p></li>
<li><p><a class="reference internal" href="#operator-logging"><span class="std std-ref">operator logging</span></a></p></li>
</ul>
<section id="expected-parameters">
<h3>Expected Parameters<a class="headerlink" href="#expected-parameters" title="Link to this heading"></a></h3>
<p>A more detailed explanation about the expected parameters can be found in <a class="reference internal" href="parameters.html#parameters"><span class="std std-ref">parameters section</span></a>.
This section presents only the expected parameters of the Operator instances.</p>
<section id="operatorimagename-default-none">
<h4><em>operatorImageName</em> (default: None)<a class="headerlink" href="#operatorimagename-default-none" title="Link to this heading"></a></h4>
<p>The name of the Docker image, where you included the implemented Operator. This will mainly be used by the
container related deployers.</p>
</section>
<section id="replicationfactor-default-0">
<h4><em>replicationFactor</em> (default: 0)<a class="headerlink" href="#replicationfactor-default-0" title="Link to this heading"></a></h4>
<p>This value will determine, how many replicas shall be created from an operator.</p>
<p>Check <cite>operator replication &lt;operator_replication&gt;</cite> for more information.</p>
</section>
</section>
<section id="connections">
<span id="operator-connection"></span><h3>Connections<a class="headerlink" href="#connections" title="Link to this heading"></a></h3>
<p>You can connect operators by the so called port plugins
(<a class="reference internal" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.InputPortPlugin" title="pypz.core.specs.plugin.InputPortPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">InputPortPlugin</span></code></a>,
<a class="reference internal" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.OutputPortPlugin" title="pypz.core.specs.plugin.OutputPortPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">OutputPortPlugin</span></code></a>).</p>
<p>The connection can be defined on pipeline level, where you shall specify, which operator’s which port plugin
shall be connected to which other operator’s which port plugin.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">WriterOperator</span><span class="p">(</span><span class="n">Operator</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_port</span> <span class="o">=</span> <span class="n">OutputPortPlugin</span><span class="p">()</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ReaderOperator</span><span class="p">(</span><span class="n">Operator</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_port</span> <span class="o">=</span> <span class="n">InputPortPlugin</span><span class="p">()</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CustomPipeline</span><span class="p">(</span><span class="n">Pipeline</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reader_operator</span> <span class="o">=</span> <span class="n">ReaderOperator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer_operator</span> <span class="o">=</span> <span class="n">WriterOperator</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reader_operator</span><span class="o">.</span><span class="n">input_port</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">writer_operator</span><span class="o">.</span><span class="n">output_port</span><span class="p">)</span>
</pre></div>
</div>
<p>Check <a class="reference internal" href="data_transfer.html#data-transfer"><span class="std std-ref">Data Transfer</span></a> for more details.</p>
</section>
<section id="replication">
<span id="operator-replication"></span><h3>Replication<a class="headerlink" href="#replication" title="Link to this heading"></a></h3>
<p>Let’s take the following pipeline as example:</p>
<figure class="align-center" id="id6">
<img alt="Without replication" src="../_images/sample_pipeline_wo_replication.png" />
<figcaption>
<p><span class="caption-text">Without replication</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The first operator reads the files from some share, the second operator performs
some KPI extraction and the third operator aggregates the results and stores
in some database.</p>
<p>If there is 1 million files and the KPI extraction takes 1 second for each
file then it takes ~11.5 days to go through all the files. This is why <em>pypz</em>
provides the feature of operator replication. This enables a selective scaling
in the pipeline. For example, let’s replicate the KPI extractor operator 99x,
which will result in total 100 operator (original + replicas):</p>
<figure class="align-center" id="id7">
<img alt="With replication" src="../_images/sample_pipeline_w_replication.png" />
<figcaption>
<p><span class="caption-text">With replication</span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The output of the FileReader operator will distribute the files evenly across
all the processor operator, hence those will share the load, which will result
appr. 100x faster execution. This results ~2.7 hours for the entire set instead
of 11.5 days.</p>
<p>Based on your capacities, you can go even higher with the replication to reduce even more the processing time.</p>
<p>Replication at its core means that a <em>pypz</em> creates an Instance based on the following rules:</p>
<ul class="simple">
<li><p>the replica instance has the same type (class) as the original</p></li>
<li><p>the original and the replica instances are forming a group, where the original is called principal</p></li>
<li><p>each replica has a permanent index attached to it, which is visible in the name of the instance e.g.,
if the original operator’s name is ‘inst’ then the first replica’s name is ‘inst_0’</p></li>
<li><p>to ensure consistency across instances all the attributes of the original operator is shared with the
replicas like parameters, connections, etc.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the concept of replications differs from scaling in a way that with setting the replication
factor, you are creating copies of the original. A replication factor of 0 does not delete the original,
it just does not create additional copies.</p>
</div>
</section>
<section id="methods">
<span id="operator-methods"></span><h3>Methods<a class="headerlink" href="#methods" title="Link to this heading"></a></h3>
<p>The <a class="reference internal" href="../indexes/core/pypz.core.specs.operator.html#pypz.core.specs.operator.Operator" title="pypz.core.specs.operator.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a> class provides methods to implement your business logic.
Each method is called in specific order based on the <a class="reference internal" href="executor.html#executor"><span class="std std-ref">executor</span></a> implementation.</p>
<ul class="simple">
<li><p><a class="reference internal" href="../indexes/core/pypz.core.specs.operator.html#pypz.core.specs.operator.Operator._on_init" title="pypz.core.specs.operator.Operator._on_init"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_on_init()</span></code></a></p></li>
<li><p><a class="reference internal" href="../indexes/core/pypz.core.specs.operator.html#pypz.core.specs.operator.Operator._on_running" title="pypz.core.specs.operator.Operator._on_running"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_on_running()</span></code></a></p></li>
<li><p><a class="reference internal" href="../indexes/core/pypz.core.specs.operator.html#pypz.core.specs.operator.Operator._on_shutdown" title="pypz.core.specs.operator.Operator._on_shutdown"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_on_shutdown()</span></code></a></p></li>
</ul>
</section>
<section id="logging">
<span id="operator-logging"></span><h3>Logging<a class="headerlink" href="#logging" title="Link to this heading"></a></h3>
<p>Although the logging functionality is provided by the <a class="reference internal" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.LoggerPlugin" title="pypz.core.specs.plugin.LoggerPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">LoggerPlugin</span></code></a> class,
the <a class="reference internal" href="../indexes/core/pypz.core.specs.operator.html#pypz.core.specs.operator.Operator" title="pypz.core.specs.operator.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a> class provides an aggregated logging interface,
which means that should there be multiple <a class="reference internal" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.LoggerPlugin" title="pypz.core.specs.plugin.LoggerPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">LoggerPlugin</span></code></a> in an
operator context, with a single method call all LoggerPlugins’ corresponding method will be called in the background:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Text to log&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The aggregated logger is realized by the class <a class="reference internal" href="../indexes/core/pypz.core.specs.operator.html#pypz.core.specs.operator.Operator.Logger" title="pypz.core.specs.operator.Operator.Logger"><code class="xref py py-class docutils literal notranslate"><span class="pre">pypz.core.specs.operator.Operator.Logger</span></code></a>.</p>
<p>Check the <a class="reference internal" href="logging.html#logging"><span class="std std-ref">Logging</span></a> section for more information.</p>
</section>
</section>
<section id="plugins">
<span id="id3"></span><h2>Plugins<a class="headerlink" href="#plugins" title="Link to this heading"></a></h2>
<p>Plugins are the lowest level entities in <em>pypz</em>. They allow to extend an enhance the functionality
of an operator. As you can check on the <a class="reference internal" href="#inheritance-diagram"><span class="std std-ref">Inheritance diagram</span></a>,
there are several plugin interfaces with different purposes:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.InputPortPlugin" title="pypz.core.specs.plugin.InputPortPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">InputPortPlugin</span></code></a></p></li>
<li><p><a class="reference internal" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.OutputPortPlugin" title="pypz.core.specs.plugin.OutputPortPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">OutputPortPlugin</span></code></a></p></li>
<li><p><a class="reference internal" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.ResourceHandlerPlugin" title="pypz.core.specs.plugin.ResourceHandlerPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceHandlerPlugin</span></code></a></p></li>
<li><p><a class="reference internal" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.ServicePlugin" title="pypz.core.specs.plugin.ServicePlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">ServicePlugin</span></code></a></p></li>
<li><p><a class="reference internal" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.ExtendedPlugin" title="pypz.core.specs.plugin.ExtendedPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtendedPlugin</span></code></a></p></li>
<li><p><a class="reference internal" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.LoggerPlugin" title="pypz.core.specs.plugin.LoggerPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">LoggerPlugin</span></code></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../general/changelog.html" class="btn btn-neutral float-left" title="Changelog" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="parameters.html" class="btn btn-neutral float-right" title="Parameters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Laszlo Anka.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>