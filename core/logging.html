<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Logging &mdash; pypz  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Deployer" href="deployer.html" />
    <link rel="prev" title="Executor" href="executor.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            pypz
          </a>
              <div class="version">
                0.9.0b5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/changelog.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_transfer.html">Data transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="executor.html">Executor</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Logging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#context-logging">Context Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#operator-logging">Operator Logging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deployer.html">Deployer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../plugins/kafka_io.html">Kafka IO Plugin</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deployers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../deployers/kubernetes.html">Kubernetes Deployer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sniffer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sniffer/overview.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guides/ht_create_pipeline.html">How to create a pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/ht_debug_in_operator.html">How to debug in a deployed operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/ht_contribute.html">Contributor’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/ht_develop.html">Developer’s Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/lazlowa/pypz-python">Source Code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/lazlowa/pypz-starter-template">Starter Template Project</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/lazlowa/pypz-examples">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pypz</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Logging</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/core/logging.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="logging">
<span id="id1"></span><h1>Logging<a class="headerlink" href="#logging" title="Link to this heading"></a></h1>
<section id="context-logging">
<h2>Context Logging<a class="headerlink" href="#context-logging" title="Link to this heading"></a></h2>
<p>Since <em>pypz</em> has a <a class="reference internal" href="models.html#models"><span class="std std-ref">multi-layered design</span></a> and entities on each layer are existing in their own context,
we want to have a logging concept that is consistent and reusable across contexts. For example,
if a plugin wants to log something, then it would be nice to reuse the logger of the operator, but denoting that
the log came from the plugin’s context.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">operator</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;something&quot;</span><span class="p">)</span>
<span class="n">plugin</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;something&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">INFO | pipeline | operator - something</span>
<span class="go">INFO | pipeline | operator | plugin - something</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since a pipeline is a virtual organization of operators, it does not have logger interface, but acts as a
context for the operators.</p>
</div>
<p>So we have the following requirements:</p>
<ul class="simple">
<li><p>one logger to rule them all</p></li>
<li><p>context information shall be available based on from where the logger is called</p></li>
</ul>
<p>The concept involves the following classes:</p>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pypz.core.commons.loggers.</span></span><span class="sig-name descname"><span class="pre">ContextLoggerInterface</span></span></dt>
<dd><p>This interface provides the necessary methods to be able to implement
the context logging functionality. Context logging means that there
is exactly one logger, which will be (re)used in the given context.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pypz.core.commons.loggers.</span></span><span class="sig-name descname"><span class="pre">ContextLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../indexes/core/pypz.core.commons.loggers.html#pypz.core.commons.loggers.ContextLoggerInterface" title="pypz.core.commons.loggers.ContextLoggerInterface"><span class="pre">ContextLoggerInterface</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">context_stack</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>This class has the responsibility to provide a simple logging interface, which
hides the complexity of maintaining the context information. The user can
call the familiar methods without knowing, how the context information are
handled by the protected methods.</p>
<p>By expecting a logger in the constructor we are allowing to reuse existing loggers
from higher contexts i.e., a top-level instance can provide it’s logger to the
nested instances along with the context information. The nested instance can
further forward to it’s nested instances and so on. Each instance provides itself
to the context stack so, if a logger method of the actual context will be called,
then the logger itself will get the context information automatically.</p>
</dd></dl>

<p>The <cite>ContextLoggerInterface</cite> shall be used to implement the actual logging functionality. Notice that
this class provides protected methods that shall not be called directly. The <cite>ContextLogger</cite> provides
the functionality to call the methods of <cite>ContextLoggerInterface</cite> so that it supplies the context
information in the background. You will then use a <cite>ContextLogger</cite> object to perform logging.</p>
</section>
<section id="operator-logging">
<h2>Operator Logging<a class="headerlink" href="#operator-logging" title="Link to this heading"></a></h2>
<p>Since an operator is a self-contained entity, we need to ensure that there is only one logger within
an operator context, which can be used by the operator and the nested plugins as well. An additional
twist to the story that there might be multiple logger plugins in an operator. Instead of calling
each logger plugins’ corresponding methods manually, we want to abstract this, so for the user it
is one call.</p>
<p>The following diagram shows the inheritance map of the logging-relevant classes:</p>
<figure class="align-default" id="id2">
<div class="graphviz"><img src="../_images/inheritance-8e90ad792ef1dac1deca22691031b37b89373cdb.png" alt="Inheritance diagram of pypz.core.specs.plugin.LoggerPlugin, pypz.core.commons.loggers.ContextLogger, pypz.plugins.loggers.default.DefaultLoggerPlugin" usemap="#inheritance694f7133b1" class="inheritance graphviz" /></div>
<map id="inheritance694f7133b1" name="inheritance694f7133b1">
<area shape="poly" id="node3" href="../indexes/core/pypz.core.commons.loggers.html#pypz.core.commons.loggers.ContextLoggerInterface" target="_top" title="This interface provides the necessary methods to be able to implement" alt="" coords="677,480,665,472,630,465,577,459,509,455,434,454,359,455,291,459,238,465,203,472,191,480,203,488,238,496,291,502,359,505,434,507,509,505,577,502,630,496,665,488"/>
<area shape="poly" id="node6" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.LoggerPlugin" target="_top" title="This addon interface allows to implement different logging technologies" alt="" coords="1075,686,1068,678,1048,671,1018,665,979,661,936,660,894,661,855,665,824,671,805,678,798,686,805,694,824,702,855,708,894,711,936,713,979,711,1018,708,1048,702,1068,694"/>
<area shape="poly" id="node8" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.Instance" target="_top" title="This class represents the instance specs that serves as base for" alt="" coords="1268,274,1263,266,1250,259,1229,253,1203,249,1175,248,1146,249,1120,253,1099,259,1086,266,1081,274,1086,282,1099,290,1120,296,1146,299,1175,301,1203,299,1229,296,1250,290,1263,282"/>
<area shape="poly" id="node10" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.InstanceGroup" target="_top" title="This class provides methods to access instance group related information. It can be" alt="" coords="1033,274,1025,266,1003,259,969,253,926,249,879,248,832,249,789,253,755,259,733,266,725,274,733,282,755,290,789,296,832,299,879,301,926,299,969,296,1003,290,1025,282"/>
<area shape="poly" id="node11" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.Plugin" target="_top" title="This interface has the only purpose to separate the plugin interfaces" alt="" coords="1128,480,1124,472,1114,465,1099,459,1079,455,1057,454,1035,455,1016,459,1000,465,990,472,987,480,990,488,1000,496,1016,502,1035,505,1057,507,1079,505,1099,502,1114,496,1124,488"/>
<area shape="poly" id="node2" href="../indexes/core/pypz.core.commons.loggers.html#pypz.core.commons.loggers.ContextLogger" target="_top" title="This class has the responsibility to provide a simple logging interface, which" alt="" coords="313,686,306,678,284,671,249,665,206,661,158,660,111,661,67,665,33,671,11,678,3,686,11,694,33,702,67,708,111,711,158,713,206,711,249,708,284,702,306,694"/>
<area shape="poly" id="node4" href="../indexes/core/pypz.core.commons.loggers.html#pypz.core.commons.loggers.DefaultContextLogger" target="_top" title="DefaultContextLogger" alt="" coords="782,686,771,678,739,671,689,665,626,661,556,660,486,661,422,665,372,671,340,678,329,686,340,694,372,702,422,708,486,711,556,713,626,711,689,708,739,702,771,694"/>
<area shape="poly" id="node5" href="../indexes/core/pypz.plugins.loggers.default.html#pypz.plugins.loggers.default.DefaultLoggerPlugin" target="_top" title="DefaultLoggerPlugin" alt="" coords="956,892,946,884,916,877,870,871,811,867,746,866,681,867,622,871,576,877,546,884,536,892,546,900,576,908,622,914,681,917,746,919,811,917,870,914,916,908,946,900"/>
<area shape="poly" id="node9" href="../indexes/core/pypz.core.specs.instance.html#pypz.core.specs.instance.RegisteredInterface" target="_top" title="This is a marker interface with the sole purpose to identify the native specs interfaces." alt="" coords="1528,68,1518,60,1490,53,1445,47,1388,43,1325,42,1262,43,1205,47,1160,53,1131,60,1121,68,1131,76,1160,84,1205,90,1262,93,1325,95,1388,93,1445,90,1490,84,1518,76"/>
</map><figcaption>
<p><span class="caption-text">Inheritance diagram</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Notice that the <cite>LoggerPlugin</cite> interface inherits from the <cite>ContextLoggerInterface</cite>, so if you implement
a logger plugin, then you actually implement the <cite>ContextLoggerInterface</cite>.</p>
<p>Furthermore, there is a <cite>ContextLoggerInterface</cite> implementation in the Operator:</p>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pypz.core.specs.operator.Operator.</span></span><span class="sig-name descname"><span class="pre">Logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logger_plugins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../indexes/core/pypz.core.specs.plugin.html#pypz.core.specs.plugin.LoggerPlugin" title="pypz.core.specs.plugin.LoggerPlugin"><span class="pre">LoggerPlugin</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span></dt>
<dd><p>This is a wrapper class for the logging functionality. It wraps all the
implementations of the LoggerAddons and by invoking either method it
will invoke the corresponding method of each LoggerAddons.</p>
</dd></dl>

<p>This class implements the functionality to abstract the method call of all LoggerPlugins in the operator context.</p>
<p>If you check the Operator’s constructor, you will notice the member <cite>self.__logger</cite>. This is actually a <cite>ContextLogger</cite>
object, where the Operator.Logger is provided as logger implementation and the context is the full name of the
operator. This is the one and only logger in the entire operator context. If a plugin is created within this context,
then it creates its own <cite>ContextLogger</cite> object, however as the logger implementation it will take the logger of
the operator, while adding its own context to the context list. Hence, if any logger method will be called inside
the plugin, it will be routed to the operator’s <cite>ContextLogger</cite>, which invokes the implemented method of the
Operator.Logger, which will call all the LoggerPlugins’ corresponding method.</p>
<p>To access the logger in either the operator or plugin context, you simply need to invoke the <code class="docutils literal notranslate"><span class="pre">get_logger()</span></code> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">operator</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;something&quot;</span><span class="p">)</span>
<span class="n">plugin</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;something&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently there is a guard in Operator.Logger, which will trace back the call stack and will throw an exception
if a LoggerPlugin tries to invoke any of the logger methods. This will prevent recursion at a cost of some
CPU load.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="executor.html" class="btn btn-neutral float-left" title="Executor" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="deployer.html" class="btn btn-neutral float-right" title="Deployer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Laszlo Anka.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>